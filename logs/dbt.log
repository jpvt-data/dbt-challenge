[0m11:11:52.064667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB7ED6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB7ED4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB7ED7920>]}


============================== 11:11:52.107695 | 249e7347-64da-4b3f-a394-82d4c71e409c ==============================
[0m11:11:52.107695 [info ] [MainThread]: Running with dbt=1.7.9
[0m11:11:52.112677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:01.934671 [debug] [MainThread]: Starter project path: D:\BigPapaProject\Anaconda\envs\dbt1\Lib\site-packages\dbt\include\starter_project
[0m11:15:03.722921 [info ] [MainThread]: 
Your new dbt project "dbt_projet" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:15:03.726919 [info ] [MainThread]: Setting up your profile.
[0m11:17:56.717939 [debug] [MainThread]: Command `dbt init` succeeded at 11:17:56.717939 after 365.48 seconds
[0m11:17:56.718936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB7D54F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB7C80800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DB83843E0>]}
[0m11:17:56.720936 [debug] [MainThread]: Flushing usage events
[0m12:08:22.010840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2F7ED400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2F7ED280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2F7ED190>]}


============================== 12:08:22.021972 | 9232e0ef-02bd-4a99-a314-b991a78f3bd9 ==============================
[0m12:08:22.021972 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:08:22.024834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:22.026833 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path D:\BigPapaProject\GitHub\dbt-challenge\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m12:08:22.031837 [debug] [MainThread]: Command `dbt run` failed at 12:08:22.030838 after 0.48 seconds
[0m12:08:22.032976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2C016660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2F593BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A2F7ECA10>]}
[0m12:08:22.035837 [debug] [MainThread]: Flushing usage events
[0m12:43:55.258931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E7F2DFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E7F2D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E7F2DD90>]}


============================== 12:43:55.295471 | 5d1faa29-6180-47b0-9b5c-e8ba0859f403 ==============================
[0m12:43:55.295471 [info ] [MainThread]: Running with dbt=1.7.9
[0m12:43:55.301462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:43:55.973631 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_projet", target "dev" invalid: ['schema'] is not valid under any of the given schemas
[0m12:43:55.976632 [debug] [MainThread]: Command `dbt run` failed at 12:43:55.976632 after 2.44 seconds
[0m12:43:55.983636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E83FC350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E737C3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246E8427CB0>]}
[0m12:43:55.985636 [debug] [MainThread]: Flushing usage events
[0m13:57:10.901548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBF18D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBEE836B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBF18DAC0>]}


============================== 13:57:10.914553 | 3929f4db-5dda-4af9-9b17-6b5470dbe9c0 ==============================
[0m13:57:10.914553 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:57:10.916552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.169711 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_projet", target "dev" invalid: ['schema'] is not valid under any of the given schemas
[0m13:57:11.173620 [debug] [MainThread]: Command `dbt run` failed at 13:57:11.173620 after 0.72 seconds
[0m13:57:11.175621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBEF10620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBEFB2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEBF331190>]}
[0m13:57:11.176619 [debug] [MainThread]: Flushing usage events
[0m13:58:39.737123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578168D790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578168D700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002578168D640>]}


============================== 13:58:39.748129 | e56c49ba-691a-4ff1-862e-9f3ddbc8afde ==============================
[0m13:58:39.748129 [info ] [MainThread]: Running with dbt=1.7.9
[0m13:58:39.750128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:39.969186 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "dbt_challenge", target "dev" invalid: ['schema'] is not valid under any of the given schemas
[0m13:58:39.973310 [debug] [MainThread]: Command `dbt run` failed at 13:58:39.972307 after 0.56 seconds
[0m13:58:39.974186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257817B4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257FE6603B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025781A6C320>]}
[0m13:58:39.976186 [debug] [MainThread]: Flushing usage events
[0m14:00:14.518596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DDDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DDF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DDEBD0>]}


============================== 14:00:14.529740 | ad6dac7a-61a6-4c85-bfd1-118c271f0951 ==============================
[0m14:00:14.529740 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:00:14.532599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:00:15.198189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2E84650>]}
[0m14:00:15.518066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2E3C6B0>]}
[0m14:00:15.521070 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:00:15.556082 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:00:15.569081 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:00:15.572082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D32C6AB0>]}
[0m14:00:19.876168 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.example
[0m14:00:19.898294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D3330230>]}
[0m14:00:19.946186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D463D400>]}
[0m14:00:19.947185 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m14:00:19.949185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D4631D00>]}
[0m14:00:19.958193 [info ] [MainThread]: 
[0m14:00:19.964190 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:00:19.968191 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:00:20.020203 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:00:20.023208 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:00:20.025207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:20.975971 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:00:20.981972 [debug] [ThreadPool]: On list_schemas: Close
[0m14:00:20.992975 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m14:00:21.018979 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:00:21.023983 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m14:00:21.027072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:22.803426 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m14:00:22.806430 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:00:22.808427 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m14:00:22.817431 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:00:22.825436 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m14:00:22.829434 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m14:00:22.848438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D47CB6E0>]}
[0m14:00:22.851440 [debug] [MainThread]: Using mysql connection "master"
[0m14:00:22.853440 [debug] [MainThread]: On master: BEGIN
[0m14:00:22.858441 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:23.897801 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:00:23.899703 [debug] [MainThread]: On master: COMMIT
[0m14:00:23.900703 [debug] [MainThread]: Using mysql connection "master"
[0m14:00:23.901703 [debug] [MainThread]: On master: COMMIT
[0m14:00:23.905706 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:23.907706 [debug] [MainThread]: On master: Close
[0m14:00:23.911705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:23.914707 [info ] [MainThread]: 
[0m14:00:23.924710 [debug] [Thread-1 (]: Began running node model.dbt_challenge.my_first_dbt_model
[0m14:00:23.926731 [info ] [Thread-1 (]: 1 of 2 START sql table model my_dbt_db.my_first_dbt_model ...................... [RUN]
[0m14:00:23.930711 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.dbt_challenge.my_first_dbt_model'
[0m14:00:23.931710 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.my_first_dbt_model
[0m14:00:23.963722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.my_first_dbt_model"
[0m14:00:23.984725 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.my_first_dbt_model (compile): 14:00:23.932712 => 14:00:23.982724
[0m14:00:23.986725 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.my_first_dbt_model
[0m14:00:24.123759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.my_first_dbt_model"
[0m14:00:24.130761 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:24.131762 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: BEGIN
[0m14:00:24.132762 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:24.983973 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:00:24.984975 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:24.987045 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_first_dbt_model"} */

  
    

  create  table
    `my_dbt_db`.`my_first_dbt_model__dbt_tmp`
    
    
      as
    
    (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    )

  
[0m14:00:25.037983 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:00:25.058988 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:25.060988 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_first_dbt_model"} */

    drop table if exists `my_dbt_db`.`my_first_dbt_model` cascade
  
[0m14:00:25.067082 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:25.069991 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:25.071993 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_first_dbt_model"} */

    rename table `my_dbt_db`.`my_first_dbt_model__dbt_tmp` to `my_dbt_db`.`my_first_dbt_model`
  
[0m14:00:25.102001 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:25.166019 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: COMMIT
[0m14:00:25.168017 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:25.172017 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: COMMIT
[0m14:00:25.176016 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:25.199024 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_first_dbt_model"
[0m14:00:25.201025 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_first_dbt_model"} */
drop table if exists `my_dbt_db`.`my_first_dbt_model__dbt_backup`
[0m14:00:25.211028 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:25.217027 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.my_first_dbt_model (execute): 14:00:23.991727 => 14:00:25.216027
[0m14:00:25.218129 [debug] [Thread-1 (]: On model.dbt_challenge.my_first_dbt_model: Close
[0m14:00:25.227034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2DDE990>]}
[0m14:00:25.229031 [info ] [Thread-1 (]: 1 of 2 OK created sql table model my_dbt_db.my_first_dbt_model ................. [[32mSUCCESS 2[0m in 1.30s]
[0m14:00:25.233034 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.my_first_dbt_model
[0m14:00:25.236036 [debug] [Thread-1 (]: Began running node model.dbt_challenge.my_second_dbt_model
[0m14:00:25.239038 [info ] [Thread-1 (]: 2 of 2 START sql view model my_dbt_db.my_second_dbt_model ...................... [RUN]
[0m14:00:25.244035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_challenge.my_first_dbt_model, now model.dbt_challenge.my_second_dbt_model)
[0m14:00:25.245035 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.my_second_dbt_model
[0m14:00:25.256041 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.my_second_dbt_model"
[0m14:00:25.261042 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.my_second_dbt_model (compile): 14:00:25.247038 => 14:00:25.260040
[0m14:00:25.265043 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.my_second_dbt_model
[0m14:00:25.609127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.my_second_dbt_model"
[0m14:00:25.613142 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:25.616221 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: BEGIN
[0m14:00:25.617197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:26.397418 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:00:26.398420 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:26.400322 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_second_dbt_model"} */

  create view `my_dbt_db`.`my_second_dbt_model__dbt_tmp`
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from `my_dbt_db`.`my_first_dbt_model`
where id = 1
  );
[0m14:00:26.422421 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:26.432336 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:26.433332 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_second_dbt_model"} */

    drop view if exists `my_dbt_db`.`my_second_dbt_model` cascade
  
[0m14:00:26.440405 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:26.444330 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:26.445337 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_second_dbt_model"} */

    rename table `my_dbt_db`.`my_second_dbt_model__dbt_tmp` to `my_dbt_db`.`my_second_dbt_model`
  
[0m14:00:26.455335 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:26.461336 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: COMMIT
[0m14:00:26.462440 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:26.464346 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: COMMIT
[0m14:00:26.467441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:26.475342 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.my_second_dbt_model"
[0m14:00:26.477340 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.my_second_dbt_model"} */
drop view if exists `my_dbt_db`.`my_second_dbt_model__dbt_backup`
[0m14:00:26.482438 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:26.487445 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.my_second_dbt_model (execute): 14:00:25.267043 => 14:00:26.486446
[0m14:00:26.489347 [debug] [Thread-1 (]: On model.dbt_challenge.my_second_dbt_model: Close
[0m14:00:26.494347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6dac7a-61a6-4c85-bfd1-118c271f0951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D4857EF0>]}
[0m14:00:26.497447 [info ] [Thread-1 (]: 2 of 2 OK created sql view model my_dbt_db.my_second_dbt_model ................. [[32mSUCCESS 0[0m in 1.25s]
[0m14:00:26.500422 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.my_second_dbt_model
[0m14:00:26.508349 [debug] [MainThread]: Using mysql connection "master"
[0m14:00:26.509350 [debug] [MainThread]: On master: BEGIN
[0m14:00:26.512349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:27.290405 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:00:27.292405 [debug] [MainThread]: On master: COMMIT
[0m14:00:27.294405 [debug] [MainThread]: Using mysql connection "master"
[0m14:00:27.295406 [debug] [MainThread]: On master: COMMIT
[0m14:00:27.299407 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:00:27.300406 [debug] [MainThread]: On master: Close
[0m14:00:27.307408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:27.308410 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m14:00:27.310408 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m14:00:27.311424 [debug] [MainThread]: Connection 'model.dbt_challenge.my_second_dbt_model' was properly closed.
[0m14:00:27.313411 [info ] [MainThread]: 
[0m14:00:27.317413 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m14:00:27.325411 [debug] [MainThread]: Command end result
[0m14:00:27.365420 [info ] [MainThread]: 
[0m14:00:27.368421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:27.371423 [info ] [MainThread]: 
[0m14:00:27.375427 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:00:27.381425 [debug] [MainThread]: Command `dbt run` succeeded at 14:00:27.378426 after 13.30 seconds
[0m14:00:27.386430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D2168B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9D1E68440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9CFE401D0>]}
[0m14:00:27.392427 [debug] [MainThread]: Flushing usage events
[0m14:28:10.860911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0BFEB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0BFE240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0BFCF20>]}


============================== 14:28:10.872776 | 2668b451-730d-486d-b29b-e37482f3dfab ==============================
[0m14:28:10.872776 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:28:10.875903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:11.648785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0C9D0A0>]}
[0m14:28:11.923835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0AFED50>]}
[0m14:28:11.926712 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:28:11.958722 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:28:11.981728 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:28:11.983728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C122BC20>]}
[0m14:28:15.322383 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m14:28:15.355392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C14054C0>]}
[0m14:28:15.403404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C2582180>]}
[0m14:28:15.404403 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m14:28:15.407414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C117C470>]}
[0m14:28:15.413407 [info ] [MainThread]: 
[0m14:28:15.417423 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:28:15.423410 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:28:15.467423 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:28:15.470420 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:28:15.471422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:16.219610 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:28:16.223615 [debug] [ThreadPool]: On list_schemas: Close
[0m14:28:16.230614 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m14:28:16.246616 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:28:16.247622 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m14:28:16.248619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:17.134840 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:28:17.136847 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:28:17.137843 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m14:28:17.142841 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m14:28:17.146849 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m14:28:17.148845 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m14:28:17.160844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C13D3BC0>]}
[0m14:28:17.161847 [debug] [MainThread]: Using mysql connection "master"
[0m14:28:17.163848 [debug] [MainThread]: On master: BEGIN
[0m14:28:17.164853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:17.930190 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:28:17.931191 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.933191 [debug] [MainThread]: Using mysql connection "master"
[0m14:28:17.934191 [debug] [MainThread]: On master: COMMIT
[0m14:28:17.937193 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:17.938198 [debug] [MainThread]: On master: Close
[0m14:28:17.942277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:17.944197 [info ] [MainThread]: 
[0m14:28:17.951223 [debug] [Thread-1 (]: Began running node model.dbt_challenge.stg_customers
[0m14:28:17.953199 [info ] [Thread-1 (]: 1 of 1 START sql view model my_dbt_db.stg_customers ............................ [RUN]
[0m14:28:17.958200 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.dbt_challenge.stg_customers'
[0m14:28:17.959199 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.stg_customers
[0m14:28:17.986211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.stg_customers"
[0m14:28:17.991209 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (compile): 14:28:17.960202 => 14:28:17.990209
[0m14:28:17.993212 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.stg_customers
[0m14:28:18.102261 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.stg_customers"
[0m14:28:18.106237 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.108238 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: BEGIN
[0m14:28:18.109236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:18.774711 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:28:18.775709 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.777713 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

  create view `my_dbt_db`.`stg_customers__dbt_tmp`
    
    
  as (
    with source as (
    select * from `my_dbt_db`.`raw_customers`
),
renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)
select * from renamed
  );
[0m14:28:18.790713 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:18.810721 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.811721 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    drop view if exists `my_dbt_db`.`stg_customers` cascade
  
[0m14:28:18.816666 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:18.820791 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.821791 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    rename table `my_dbt_db`.`stg_customers__dbt_tmp` to `my_dbt_db`.`stg_customers`
  
[0m14:28:18.829669 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:18.875685 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m14:28:18.876682 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.878686 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m14:28:18.881682 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:18.896687 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:28:18.897690 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */
drop view if exists `my_dbt_db`.`stg_customers__dbt_backup`
[0m14:28:18.903688 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:18.907690 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (execute): 14:28:17.995209 => 14:28:18.907690
[0m14:28:18.909815 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: Close
[0m14:28:18.914671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2668b451-730d-486d-b29b-e37482f3dfab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C1482CC0>]}
[0m14:28:18.915670 [info ] [Thread-1 (]: 1 of 1 OK created sql view model my_dbt_db.stg_customers ....................... [[32mSUCCESS 0[0m in 0.96s]
[0m14:28:18.919670 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.stg_customers
[0m14:28:18.923792 [debug] [MainThread]: Using mysql connection "master"
[0m14:28:18.924668 [debug] [MainThread]: On master: BEGIN
[0m14:28:18.927672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:19.839846 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:28:19.840846 [debug] [MainThread]: On master: COMMIT
[0m14:28:19.842975 [debug] [MainThread]: Using mysql connection "master"
[0m14:28:19.843989 [debug] [MainThread]: On master: COMMIT
[0m14:28:19.845849 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:28:19.847866 [debug] [MainThread]: On master: Close
[0m14:28:19.852850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:19.853851 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m14:28:19.854982 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m14:28:19.855977 [debug] [MainThread]: Connection 'model.dbt_challenge.stg_customers' was properly closed.
[0m14:28:19.856850 [info ] [MainThread]: 
[0m14:28:19.858852 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m14:28:19.861852 [debug] [MainThread]: Command end result
[0m14:28:20.022892 [info ] [MainThread]: 
[0m14:28:20.024892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:20.026894 [info ] [MainThread]: 
[0m14:28:20.028894 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:28:20.033894 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:20.032901 after 9.66 seconds
[0m14:28:20.036898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C0858CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C07348C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197C1151EB0>]}
[0m14:28:20.038898 [debug] [MainThread]: Flushing usage events
[0m14:39:48.059663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E9EABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E9EA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E9E9550>]}


============================== 14:39:48.076667 | f411ff8f-4d01-43a8-bc8c-e845aa0bad71 ==============================
[0m14:39:48.076667 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:39:48.082668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:49.771096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E566720>]}
[0m14:39:50.399254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E66E9C0>]}
[0m14:39:50.403252 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m14:39:50.469339 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m14:39:50.826360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m14:39:50.831362 [debug] [MainThread]: Partial parsing: added file: dbt_challenge://models\staging\stg_orders.yml
[0m14:39:50.834362 [debug] [MainThread]: Partial parsing: added file: dbt_challenge://models\staging\stg_orders.sql
[0m14:39:50.837364 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\sources.yml
[0m14:39:53.033916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m14:39:53.056925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287EA945C0>]}
[0m14:39:53.173953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287EFE9A30>]}
[0m14:39:53.176952 [info ] [MainThread]: Found 2 models, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m14:39:53.185956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287EEBFCB0>]}
[0m14:39:53.202959 [info ] [MainThread]: 
[0m14:39:53.206961 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m14:39:53.231966 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m14:39:53.333995 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m14:39:53.335992 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m14:39:53.337993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:54.676329 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:39:54.684455 [debug] [ThreadPool]: On list_schemas: Close
[0m14:39:54.691334 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m14:39:54.716340 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:39:54.718337 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m14:39:54.720469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:55.766601 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:39:55.769602 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m14:39:55.771600 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m14:39:55.782606 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.0 seconds
[0m14:39:55.790605 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m14:39:55.801608 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m14:39:55.833622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E462C00>]}
[0m14:39:55.835616 [debug] [MainThread]: Using mysql connection "master"
[0m14:39:55.837616 [debug] [MainThread]: On master: BEGIN
[0m14:39:55.838617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:57.287980 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:39:57.289073 [debug] [MainThread]: On master: COMMIT
[0m14:39:57.291072 [debug] [MainThread]: Using mysql connection "master"
[0m14:39:57.291981 [debug] [MainThread]: On master: COMMIT
[0m14:39:57.298983 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:57.300985 [debug] [MainThread]: On master: Close
[0m14:39:57.305983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:57.308985 [info ] [MainThread]: 
[0m14:39:57.322989 [debug] [Thread-1 (]: Began running node model.dbt_challenge.stg_customers
[0m14:39:57.323987 [info ] [Thread-1 (]: 1 of 2 START sql view model my_dbt_db.stg_customers ............................ [RUN]
[0m14:39:57.336992 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.dbt_challenge.stg_customers'
[0m14:39:57.337993 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.stg_customers
[0m14:39:57.406010 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.stg_customers"
[0m14:39:57.415018 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (compile): 14:39:57.338995 => 14:39:57.409012
[0m14:39:57.420121 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.stg_customers
[0m14:39:57.592121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.stg_customers"
[0m14:39:57.599059 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:57.601061 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: BEGIN
[0m14:39:57.603060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:59.396036 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 2.0 seconds
[0m14:39:59.399035 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.401036 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

  create view `my_dbt_db`.`stg_customers__dbt_tmp`
    
    
  as (
    with source as (
    select * from `my_dbt_db`.`raw_customers`
),
renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)
select * from renamed
  );
[0m14:39:59.427041 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.466140 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.468049 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    drop view if exists `my_dbt_db`.`stg_customers__dbt_backup` cascade
  
[0m14:39:59.473064 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.478057 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.481059 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    rename table `my_dbt_db`.`stg_customers` to `my_dbt_db`.`stg_customers__dbt_backup`
  
[0m14:39:59.494057 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.506065 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.507178 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    drop view if exists `my_dbt_db`.`stg_customers` cascade
  
[0m14:39:59.519184 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.522068 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.523203 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    rename table `my_dbt_db`.`stg_customers__dbt_tmp` to `my_dbt_db`.`stg_customers`
  
[0m14:39:59.536068 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.614086 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m14:39:59.618090 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.619242 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m14:39:59.622088 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.640092 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m14:39:59.642094 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */
drop view if exists `my_dbt_db`.`stg_customers__dbt_backup`
[0m14:39:59.657207 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:39:59.665099 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (execute): 14:39:57.421118 => 14:39:59.663104
[0m14:39:59.667102 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: Close
[0m14:39:59.671237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287F39C380>]}
[0m14:39:59.673100 [info ] [Thread-1 (]: 1 of 2 OK created sql view model my_dbt_db.stg_customers ....................... [[32mSUCCESS 0[0m in 2.34s]
[0m14:39:59.678109 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.stg_customers
[0m14:39:59.682104 [debug] [Thread-1 (]: Began running node model.dbt_challenge.stg_orders
[0m14:39:59.684253 [info ] [Thread-1 (]: 2 of 2 START sql view model my_dbt_db.stg_orders ............................... [RUN]
[0m14:39:59.688106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_challenge.stg_customers, now model.dbt_challenge.stg_orders)
[0m14:39:59.690122 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.stg_orders
[0m14:39:59.718115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.stg_orders"
[0m14:39:59.728117 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_orders (compile): 14:39:59.695115 => 14:39:59.724114
[0m14:39:59.734116 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.stg_orders
[0m14:39:59.769126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.stg_orders"
[0m14:39:59.773127 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:39:59.774127 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: BEGIN
[0m14:39:59.776129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:02.421427 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 3.0 seconds
[0m14:40:02.424424 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:40:02.429425 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

  create view `my_dbt_db`.`stg_orders__dbt_tmp`
    
    
  as (
    with source as (
    select * from `my_dbt_db`.`raw_orders`
),
renamed as (
    select
        id as order_id,
        customer as customer_id
    from source
)
select * from renamed
  );
[0m14:40:02.456431 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:02.483459 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:40:02.487469 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    drop view if exists `my_dbt_db`.`stg_orders` cascade
  
[0m14:40:02.498441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:02.505474 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:40:02.508531 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    rename table `my_dbt_db`.`stg_orders__dbt_tmp` to `my_dbt_db`.`stg_orders`
  
[0m14:40:02.525537 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:02.537451 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: COMMIT
[0m14:40:02.538537 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:40:02.540539 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: COMMIT
[0m14:40:02.547493 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:02.564457 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m14:40:02.567467 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */
drop view if exists `my_dbt_db`.`stg_orders__dbt_backup`
[0m14:40:02.575459 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:02.585463 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_orders (execute): 14:39:59.736141 => 14:40:02.584462
[0m14:40:02.588466 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: Close
[0m14:40:02.599466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f411ff8f-4d01-43a8-bc8c-e845aa0bad71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287F407E00>]}
[0m14:40:02.602467 [info ] [Thread-1 (]: 2 of 2 OK created sql view model my_dbt_db.stg_orders .......................... [[32mSUCCESS 0[0m in 2.91s]
[0m14:40:02.608469 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.stg_orders
[0m14:40:02.622473 [debug] [MainThread]: Using mysql connection "master"
[0m14:40:02.631474 [debug] [MainThread]: On master: BEGIN
[0m14:40:02.634476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:04.012823 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m14:40:04.014820 [debug] [MainThread]: On master: COMMIT
[0m14:40:04.016823 [debug] [MainThread]: Using mysql connection "master"
[0m14:40:04.017819 [debug] [MainThread]: On master: COMMIT
[0m14:40:04.020937 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:40:04.021937 [debug] [MainThread]: On master: Close
[0m14:40:04.028822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:04.031824 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m14:40:04.032942 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m14:40:04.033829 [debug] [MainThread]: Connection 'model.dbt_challenge.stg_orders' was properly closed.
[0m14:40:04.035824 [info ] [MainThread]: 
[0m14:40:04.036824 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 10.83 seconds (10.83s).
[0m14:40:04.040824 [debug] [MainThread]: Command end result
[0m14:40:04.088839 [info ] [MainThread]: 
[0m14:40:04.093851 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:04.102843 [info ] [MainThread]: 
[0m14:40:04.105851 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:40:04.119846 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:04.118848 after 16.74 seconds
[0m14:40:04.120937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287E838620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287F2477A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001287EFEAFC0>]}
[0m14:40:04.122848 [debug] [MainThread]: Flushing usage events
[0m15:04:51.877069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B1EEC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B1EFEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B1EF4D0>]}


============================== 15:04:51.888161 | e4e916d7-7930-4d89-a570-cea7f212064a ==============================
[0m15:04:51.888161 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:04:51.890069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:04:52.549230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4e916d7-7930-4d89-a570-cea7f212064a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38AFD6960>]}
[0m15:04:52.821302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4e916d7-7930-4d89-a570-cea7f212064a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38A5578C0>]}
[0m15:04:52.824300 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:04:52.865312 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:04:52.920323 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_challenge: staging\stg_customers.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |     - name: stg_customers
    5  |       columns:
    6  |         - name: customer_id
    7  |         tests:
    8  | 
    9  |             - not_null
    10 | 
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 6, column 9
    did not find expected '-' indicator
      in "<unicode string>", line 7, column 9
[0m15:04:52.935328 [debug] [MainThread]: Command `dbt test` failed at 15:04:52.935328 after 1.66 seconds
[0m15:04:52.938329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B1EC2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B7ABFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C38B7D58B0>]}
[0m15:04:52.940446 [debug] [MainThread]: Flushing usage events
[0m15:17:32.721987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869AA6EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869AA6E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869AA6CE90>]}


============================== 15:17:32.734990 | 03b70416-21b9-401d-acbd-b9e42c7dbd69 ==============================
[0m15:17:32.734990 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:17:32.736990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:33.397292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869AF26720>]}
[0m15:17:33.660217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869A89AF30>]}
[0m15:17:33.663221 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:17:33.692228 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:17:33.876273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:17:33.878275 [debug] [MainThread]: Partial parsing: added file: dbt_challenge://tests\order_dates_in_the_past.sql
[0m15:17:33.879277 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_customers.yml
[0m15:17:34.929541 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:17:34.945547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869C3CFE90>]}
[0m15:17:34.994558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869B0BDE20>]}
[0m15:17:34.995557 [info ] [MainThread]: Found 2 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:17:34.997558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869C454470>]}
[0m15:17:35.004648 [info ] [MainThread]: 
[0m15:17:35.011562 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:17:35.016563 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:17:35.069671 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:17:35.070669 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:17:35.074620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:35.994809 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:35.995813 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:17:35.996954 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:17:36.001812 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:17:36.005812 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:17:36.008816 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:17:36.017915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03b70416-21b9-401d-acbd-b9e42c7dbd69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869C497AA0>]}
[0m15:17:36.018816 [debug] [MainThread]: Using mysql connection "master"
[0m15:17:36.019957 [debug] [MainThread]: On master: BEGIN
[0m15:17:36.020957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:36.801013 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:36.802012 [debug] [MainThread]: On master: COMMIT
[0m15:17:36.803015 [debug] [MainThread]: Using mysql connection "master"
[0m15:17:36.804013 [debug] [MainThread]: On master: COMMIT
[0m15:17:36.807014 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:17:36.809034 [debug] [MainThread]: On master: Close
[0m15:17:36.813017 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:36.815016 [info ] [MainThread]: 
[0m15:17:36.825020 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:17:36.827018 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:17:36.830022 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:17:36.833023 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:17:36.902041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:17:36.908040 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:17:36.837029 => 15:17:36.906040
[0m15:17:36.909054 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:17:36.954053 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:17:36.959054 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:17:36.960053 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:17:36.961052 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:37.625339 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:37.626367 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:17:37.628027 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:17:37.636242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:17:37.642331 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:17:36.910041 => 15:17:37.641388
[0m15:17:37.643242 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:17:37.646365 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:17:37.651392 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.82s]
[0m15:17:37.654248 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:17:37.657250 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:17:37.658245 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:17:37.662250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:17:37.663267 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:17:37.680253 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:17:37.693254 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:17:37.664249 => 15:17:37.691268
[0m15:17:37.697260 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:17:37.706273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:17:37.713261 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:17:37.714260 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:17:37.720261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:38.409208 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:38.411209 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:17:38.412208 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:17:38.416335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:17:38.421213 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:17:37.698255 => 15:17:38.420232
[0m15:17:38.424214 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:17:38.426216 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:17:38.431339 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.77s]
[0m15:17:38.434216 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:17:38.436217 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:17:38.437220 [info ] [Thread-1 (]: 3 of 4 START test order_dates_in_the_past ...................................... [RUN]
[0m15:17:38.440219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.order_dates_in_the_past)
[0m15:17:38.441217 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:17:38.450219 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:17:38.457222 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:17:38.442235 => 15:17:38.454222
[0m15:17:38.464224 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:17:38.473227 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:17:38.481229 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:17:38.484227 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:17:38.485228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:39.143724 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:39.145726 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:17:39.146726 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where ordered_at > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:17:39.150726 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1054 (42S22): Unknown column 'ordered_at' in 'where clause'
[0m15:17:39.152739 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:17:39.155731 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:17:38.466223 => 15:17:39.153803
[0m15:17:39.156736 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:17:39.184734 [debug] [Thread-1 (]: Database Error in test order_dates_in_the_past (tests\order_dates_in_the_past.sql)
  1054 (42S22): Unknown column 'ordered_at' in 'where clause'
  compiled Code at target\run\dbt_challenge\tests\order_dates_in_the_past.sql
[0m15:17:39.185735 [error] [Thread-1 (]: 3 of 4 ERROR order_dates_in_the_past ........................................... [[31mERROR[0m in 0.75s]
[0m15:17:39.188738 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:17:39.190739 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:17:39.193737 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:17:39.195935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:17:39.198815 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:17:39.235792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:17:39.245793 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:17:39.199796 => 15:17:39.243795
[0m15:17:39.246792 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:17:39.262817 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:17:39.265799 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:17:39.266799 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:17:39.268799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:39.924967 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:39.925969 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:17:39.926968 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:17:39.934972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:17:39.938969 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:17:39.247938 => 15:17:39.937973
[0m15:17:39.941115 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:17:39.942972 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:17:39.947999 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.75s]
[0m15:17:39.950062 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:17:39.954935 [debug] [MainThread]: Using mysql connection "master"
[0m15:17:39.955922 [debug] [MainThread]: On master: BEGIN
[0m15:17:39.957024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:40.653081 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:17:40.654085 [debug] [MainThread]: On master: COMMIT
[0m15:17:40.656087 [debug] [MainThread]: Using mysql connection "master"
[0m15:17:40.657085 [debug] [MainThread]: On master: COMMIT
[0m15:17:40.659083 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:17:40.660087 [debug] [MainThread]: On master: Close
[0m15:17:40.664086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:40.665086 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:17:40.666088 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m15:17:40.668085 [info ] [MainThread]: 
[0m15:17:40.669121 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m15:17:40.674210 [debug] [MainThread]: Command end result
[0m15:17:40.699095 [info ] [MainThread]: 
[0m15:17:40.706106 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:17:40.710099 [info ] [MainThread]: 
[0m15:17:40.713099 [error] [MainThread]:   Database Error in test order_dates_in_the_past (tests\order_dates_in_the_past.sql)
  1054 (42S22): Unknown column 'ordered_at' in 'where clause'
  compiled Code at target\run\dbt_challenge\tests\order_dates_in_the_past.sql
[0m15:17:40.715099 [info ] [MainThread]: 
[0m15:17:40.718098 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:17:40.723104 [debug] [MainThread]: Command `dbt test` failed at 15:17:40.720099 after 8.46 seconds
[0m15:17:40.726100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869A8B9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869A902510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869A7F4110>]}
[0m15:17:40.727100 [debug] [MainThread]: Flushing usage events
[0m15:20:08.200550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E3BEFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E3BF7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E3BFE60>]}


============================== 15:20:08.212554 | 1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9 ==============================
[0m15:20:08.212554 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:08.214553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:20:08.833707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E3BFBC0>]}
[0m15:20:09.106776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E453350>]}
[0m15:20:09.109777 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:20:09.145788 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:20:09.338933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:20:09.339931 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:20:09.341836 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.sql
[0m15:20:09.933986 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:20:09.955993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1EC99DC0>]}
[0m15:20:09.995000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1EA5E1B0>]}
[0m15:20:09.997144 [info ] [MainThread]: Found 2 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:20:09.999002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1EBF60C0>]}
[0m15:20:10.003004 [info ] [MainThread]: 
[0m15:20:10.007007 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:20:10.015012 [debug] [ThreadPool]: Acquiring new mysql connection 'list_schemas'
[0m15:20:10.064021 [debug] [ThreadPool]: Using mysql connection "list_schemas"
[0m15:20:10.065160 [debug] [ThreadPool]: On list_schemas: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_schemas"} */
select distinct schema_name
        from information_schema.schemata
[0m15:20:10.066158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:10.765196 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m15:20:10.768197 [debug] [ThreadPool]: On list_schemas: Close
[0m15:20:10.775200 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:20:10.789204 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:20:10.790202 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:20:10.791204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:11.717659 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:11.719661 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:20:11.721683 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:20:11.729663 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:20:11.735663 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:20:11.737664 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:20:11.755669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1EC188C0>]}
[0m15:20:11.759671 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:11.761671 [debug] [MainThread]: On master: BEGIN
[0m15:20:11.763674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:12.499997 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:12.501122 [debug] [MainThread]: On master: COMMIT
[0m15:20:12.502080 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:12.502999 [debug] [MainThread]: On master: COMMIT
[0m15:20:12.505000 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:12.506123 [debug] [MainThread]: On master: Close
[0m15:20:12.511124 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:12.513010 [info ] [MainThread]: 
[0m15:20:12.520006 [debug] [Thread-1 (]: Began running node model.dbt_challenge.stg_customers
[0m15:20:12.521123 [info ] [Thread-1 (]: 1 of 2 START sql view model my_dbt_db.stg_customers ............................ [RUN]
[0m15:20:12.526004 [debug] [Thread-1 (]: Acquiring new mysql connection 'model.dbt_challenge.stg_customers'
[0m15:20:12.528006 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.stg_customers
[0m15:20:12.552201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.stg_customers"
[0m15:20:12.555205 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (compile): 15:20:12.530007 => 15:20:12.554202
[0m15:20:12.558223 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.stg_customers
[0m15:20:12.661347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.stg_customers"
[0m15:20:12.665228 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:12.666348 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: BEGIN
[0m15:20:12.667348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:13.324548 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:13.325551 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.326551 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

  create view `my_dbt_db`.`stg_customers__dbt_tmp`
    
    
  as (
    with source as (
    select * from `my_dbt_db`.`raw_customers`
),
renamed as (
    select
        id as customer_id,
        name as customer_name
    from source
)
select * from renamed
  );
[0m15:20:13.341550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.359554 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.360556 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    drop view if exists `my_dbt_db`.`stg_customers__dbt_backup` cascade
  
[0m15:20:13.365554 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.368652 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.369678 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    rename table `my_dbt_db`.`stg_customers` to `my_dbt_db`.`stg_customers__dbt_backup`
  
[0m15:20:13.378629 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.389751 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.391635 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    drop view if exists `my_dbt_db`.`stg_customers` cascade
  
[0m15:20:13.397631 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.400743 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.401755 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */

    rename table `my_dbt_db`.`stg_customers__dbt_tmp` to `my_dbt_db`.`stg_customers`
  
[0m15:20:13.410608 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.460555 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m15:20:13.462553 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.463557 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: COMMIT
[0m15:20:13.465554 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.481675 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_customers"
[0m15:20:13.482559 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_customers"} */
drop view if exists `my_dbt_db`.`stg_customers__dbt_backup`
[0m15:20:13.490567 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:13.495561 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_customers (execute): 15:20:12.560205 => 15:20:13.494562
[0m15:20:13.496561 [debug] [Thread-1 (]: On model.dbt_challenge.stg_customers: Close
[0m15:20:13.500562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1D4783B0>]}
[0m15:20:13.502564 [info ] [Thread-1 (]: 1 of 2 OK created sql view model my_dbt_db.stg_customers ....................... [[32mSUCCESS 0[0m in 0.98s]
[0m15:20:13.505679 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.stg_customers
[0m15:20:13.507568 [debug] [Thread-1 (]: Began running node model.dbt_challenge.stg_orders
[0m15:20:13.508563 [info ] [Thread-1 (]: 2 of 2 START sql view model my_dbt_db.stg_orders ............................... [RUN]
[0m15:20:13.513570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_challenge.stg_customers, now model.dbt_challenge.stg_orders)
[0m15:20:13.514580 [debug] [Thread-1 (]: Began compiling node model.dbt_challenge.stg_orders
[0m15:20:13.526571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_challenge.stg_orders"
[0m15:20:13.530570 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_orders (compile): 15:20:13.516571 => 15:20:13.529570
[0m15:20:13.531684 [debug] [Thread-1 (]: Began executing node model.dbt_challenge.stg_orders
[0m15:20:13.548572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_challenge.stg_orders"
[0m15:20:13.551575 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:13.552575 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: BEGIN
[0m15:20:13.554577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:14.219740 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:14.220881 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.221883 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

  create view `my_dbt_db`.`stg_orders__dbt_tmp`
    
    
  as (
    with source as (
    select * from `my_dbt_db`.`raw_orders`
),
renamed as (
    select
        id as order_id,
        customer as customer_id,
        ordered_at as order_date,
        store_id
    from source
)
select * from renamed
  );
[0m15:20:14.238744 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.247745 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.249747 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    drop view if exists `my_dbt_db`.`stg_orders__dbt_backup` cascade
  
[0m15:20:14.253745 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.258748 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.260750 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    rename table `my_dbt_db`.`stg_orders` to `my_dbt_db`.`stg_orders__dbt_backup`
  
[0m15:20:14.269864 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.281753 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.282754 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    drop view if exists `my_dbt_db`.`stg_orders` cascade
  
[0m15:20:14.289755 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.293758 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.294758 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */

    rename table `my_dbt_db`.`stg_orders__dbt_tmp` to `my_dbt_db`.`stg_orders`
  
[0m15:20:14.303760 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.309760 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: COMMIT
[0m15:20:14.311764 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.312763 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: COMMIT
[0m15:20:14.315762 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.323838 [debug] [Thread-1 (]: Using mysql connection "model.dbt_challenge.stg_orders"
[0m15:20:14.324764 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "model.dbt_challenge.stg_orders"} */
drop view if exists `my_dbt_db`.`stg_orders__dbt_backup`
[0m15:20:14.333766 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:14.338770 [debug] [Thread-1 (]: Timing info for model.dbt_challenge.stg_orders (execute): 15:20:13.532572 => 15:20:14.337767
[0m15:20:14.340768 [debug] [Thread-1 (]: On model.dbt_challenge.stg_orders: Close
[0m15:20:14.345861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1386a72e-9a1d-4cd1-a6f9-8d20a92aa5a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D2011F050>]}
[0m15:20:14.347770 [info ] [Thread-1 (]: 2 of 2 OK created sql view model my_dbt_db.stg_orders .......................... [[32mSUCCESS 0[0m in 0.83s]
[0m15:20:14.350771 [debug] [Thread-1 (]: Finished running node model.dbt_challenge.stg_orders
[0m15:20:14.354771 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:14.355771 [debug] [MainThread]: On master: BEGIN
[0m15:20:14.356771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:15.020939 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:15.021939 [debug] [MainThread]: On master: COMMIT
[0m15:20:15.023940 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:15.024941 [debug] [MainThread]: On master: COMMIT
[0m15:20:15.026944 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:15.027943 [debug] [MainThread]: On master: Close
[0m15:20:15.032945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:15.033945 [debug] [MainThread]: Connection 'list_schemas' was properly closed.
[0m15:20:15.034945 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:20:15.035944 [debug] [MainThread]: Connection 'model.dbt_challenge.stg_orders' was properly closed.
[0m15:20:15.036943 [info ] [MainThread]: 
[0m15:20:15.038945 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m15:20:15.042950 [debug] [MainThread]: Command end result
[0m15:20:15.071953 [info ] [MainThread]: 
[0m15:20:15.075980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:15.079958 [info ] [MainThread]: 
[0m15:20:15.082956 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:20:15.086082 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:15.084957 after 7.32 seconds
[0m15:20:15.087078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E170620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1E190CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D1DA37080>]}
[0m15:20:15.088955 [debug] [MainThread]: Flushing usage events
[0m15:20:34.544176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178A5DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178A5C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178A5CEC0>]}


============================== 15:20:34.560181 | 82052445-23b9-4de5-b5f3-d9f196d96740 ==============================
[0m15:20:34.560181 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:20:34.562179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:20:35.300587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178FC2930>]}
[0m15:20:35.704698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178595070>]}
[0m15:20:35.707690 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:20:35.740702 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:20:35.964754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:35.965754 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:35.968755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:20:35.987760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E179065100>]}
[0m15:20:36.030773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1790A51F0>]}
[0m15:20:36.033773 [info ] [MainThread]: Found 2 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:20:36.037777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178CD78F0>]}
[0m15:20:36.043864 [info ] [MainThread]: 
[0m15:20:36.048865 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:20:36.053779 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:20:36.099788 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:20:36.101789 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:20:36.106791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:37.093040 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:37.094037 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:20:37.095040 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:20:37.101042 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:20:37.108042 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:20:37.110053 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:20:37.131048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82052445-23b9-4de5-b5f3-d9f196d96740', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178956AE0>]}
[0m15:20:37.133050 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:37.134048 [debug] [MainThread]: On master: BEGIN
[0m15:20:37.139050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:37.907242 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:37.908243 [debug] [MainThread]: On master: COMMIT
[0m15:20:37.909243 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:37.910243 [debug] [MainThread]: On master: COMMIT
[0m15:20:37.913244 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:37.914333 [debug] [MainThread]: On master: Close
[0m15:20:37.919245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:37.922247 [info ] [MainThread]: 
[0m15:20:37.930247 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:20:37.931247 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:20:37.937250 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:20:37.938250 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:20:38.014360 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:20:38.017270 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:20:37.939250 => 15:20:38.016269
[0m15:20:38.020270 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:20:38.073286 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:20:38.076284 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:20:38.078285 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:20:38.080286 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:38.810466 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:38.811465 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:20:38.813468 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:20:38.817465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:38.825470 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:20:38.022291 => 15:20:38.824467
[0m15:20:38.826469 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:20:38.828471 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:20:38.833471 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.90s]
[0m15:20:38.839473 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:20:38.840591 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:20:38.842473 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:20:38.845476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:20:38.846476 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:20:38.860480 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:20:38.865483 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:20:38.847595 => 15:20:38.863481
[0m15:20:38.867482 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:20:38.879482 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:20:38.882484 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:20:38.884485 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:20:38.887487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:39.567810 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:39.569809 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:20:39.571929 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:20:39.576813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:39.580813 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:20:38.871485 => 15:20:39.579812
[0m15:20:39.581814 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:20:39.584813 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:20:39.590958 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.75s]
[0m15:20:39.593816 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:20:39.594959 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:20:39.596816 [info ] [Thread-1 (]: 3 of 4 START test order_dates_in_the_past ...................................... [RUN]
[0m15:20:39.599817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.order_dates_in_the_past)
[0m15:20:39.600817 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:20:39.610820 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:20:39.616821 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:20:39.602818 => 15:20:39.615824
[0m15:20:39.618820 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:20:39.627824 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:20:39.631825 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:20:39.633941 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:20:39.634962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:40.342023 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:40.344015 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:20:40.345015 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where ordered_at > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:20:40.349016 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1054 (42S22): Unknown column 'ordered_at' in 'where clause'
[0m15:20:40.351015 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:20:40.357018 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:20:39.620821 => 15:20:40.355019
[0m15:20:40.358018 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:20:40.394029 [debug] [Thread-1 (]: Database Error in test order_dates_in_the_past (tests\order_dates_in_the_past.sql)
  1054 (42S22): Unknown column 'ordered_at' in 'where clause'
  compiled Code at target\run\dbt_challenge\tests\order_dates_in_the_past.sql
[0m15:20:40.396028 [error] [Thread-1 (]: 3 of 4 ERROR order_dates_in_the_past ........................................... [[31mERROR[0m in 0.80s]
[0m15:20:40.400031 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:20:40.407031 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:20:40.413033 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:20:40.422035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:20:40.426036 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:20:40.484051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:20:40.492051 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:20:40.429038 => 15:20:40.491051
[0m15:20:40.494057 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:20:40.506056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:20:40.509057 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:20:40.511056 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:20:40.512056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:41.304632 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:41.306722 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:20:41.307677 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:20:41.316659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:41.323638 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:20:40.495140 => 15:20:41.322635
[0m15:20:41.324636 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:20:41.327666 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:20:41.332640 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.92s]
[0m15:20:41.336639 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:20:41.341640 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:41.342654 [debug] [MainThread]: On master: BEGIN
[0m15:20:41.343641 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:42.289876 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:20:42.292897 [debug] [MainThread]: On master: COMMIT
[0m15:20:42.296876 [debug] [MainThread]: Using mysql connection "master"
[0m15:20:42.298882 [debug] [MainThread]: On master: COMMIT
[0m15:20:42.306879 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:42.309880 [debug] [MainThread]: On master: Close
[0m15:20:42.325883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:42.327884 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:20:42.328884 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m15:20:42.330884 [info ] [MainThread]: 
[0m15:20:42.337886 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m15:20:42.347889 [debug] [MainThread]: Command end result
[0m15:20:42.541977 [info ] [MainThread]: 
[0m15:20:42.545972 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:42.549940 [info ] [MainThread]: 
[0m15:20:42.556946 [error] [MainThread]:   Database Error in test order_dates_in_the_past (tests\order_dates_in_the_past.sql)
  1054 (42S22): Unknown column 'ordered_at' in 'where clause'
  compiled Code at target\run\dbt_challenge\tests\order_dates_in_the_past.sql
[0m15:20:42.575975 [info ] [MainThread]: 
[0m15:20:42.586950 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:20:42.599953 [debug] [MainThread]: Command `dbt test` failed at 15:20:42.598952 after 8.52 seconds
[0m15:20:42.612954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1788D2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1788A4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E178956780>]}
[0m15:20:42.628959 [debug] [MainThread]: Flushing usage events
[0m15:21:54.139515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DEBFBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DEBF2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DEBF5C0>]}


============================== 15:21:54.150510 | dd74cefd-4844-4750-b995-a1e790afbccc ==============================
[0m15:21:54.150510 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:21:54.153511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:21:54.761802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DF17AD0>]}
[0m15:21:55.037727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DCD6720>]}
[0m15:21:55.039871 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:21:55.068737 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:21:55.237779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:21:55.239920 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://tests\order_dates_in_the_past.sql
[0m15:21:55.544853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:21:55.562859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7E4C7350>]}
[0m15:21:55.600869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7E6D7CB0>]}
[0m15:21:55.602987 [info ] [MainThread]: Found 2 models, 4 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:21:55.605868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7E3F1820>]}
[0m15:21:55.611012 [info ] [MainThread]: 
[0m15:21:55.615876 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:21:55.623897 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:21:55.660023 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:21:55.660882 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:21:55.662911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:56.327051 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:21:56.328050 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:21:56.329054 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:21:56.335055 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:21:56.339167 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:21:56.341057 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:21:56.350054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd74cefd-4844-4750-b995-a1e790afbccc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7E11D550>]}
[0m15:21:56.352055 [debug] [MainThread]: Using mysql connection "master"
[0m15:21:56.353056 [debug] [MainThread]: On master: BEGIN
[0m15:21:56.355060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:57.140346 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:21:57.141346 [debug] [MainThread]: On master: COMMIT
[0m15:21:57.142254 [debug] [MainThread]: Using mysql connection "master"
[0m15:21:57.143346 [debug] [MainThread]: On master: COMMIT
[0m15:21:57.146258 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:21:57.148258 [debug] [MainThread]: On master: Close
[0m15:21:57.154260 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:57.156259 [info ] [MainThread]: 
[0m15:21:57.164260 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:21:57.166259 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:21:57.170262 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:21:57.173265 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:21:57.244282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:21:57.248399 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:21:57.175263 => 15:21:57.246281
[0m15:21:57.249399 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:21:57.293294 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:21:57.296295 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:21:57.298412 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:21:57.299413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:57.956459 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:21:57.957579 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:21:57.958580 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:21:57.963461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:21:57.968582 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:21:57.250401 => 15:21:57.968582
[0m15:21:57.971465 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:21:57.973580 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:21:57.978581 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.81s]
[0m15:21:57.980561 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:21:57.982467 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:21:57.983583 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:21:57.988470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:21:57.990471 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:21:58.007475 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:21:58.010473 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:21:57.991471 => 15:21:58.009472
[0m15:21:58.012474 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:21:58.023478 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:21:58.028479 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:21:58.029619 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:21:58.030598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:58.741776 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:21:58.742661 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:21:58.744802 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:21:58.749781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:21:58.754782 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:21:58.013474 => 15:21:58.753662
[0m15:21:58.756663 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:21:58.758668 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:21:58.763666 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.78s]
[0m15:21:58.765666 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:21:58.767664 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:21:58.769666 [info ] [Thread-1 (]: 3 of 4 START test order_dates_in_the_past ...................................... [RUN]
[0m15:21:58.773672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.order_dates_in_the_past)
[0m15:21:58.774668 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:21:58.783671 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:21:58.790673 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:21:58.776668 => 15:21:58.788671
[0m15:21:58.792674 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:21:58.800815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:21:58.808676 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:21:58.810676 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:21:58.812678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:59.549990 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:21:59.551937 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:21:59.553883 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:21:59.689898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:21:59.693900 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:21:58.793671 => 15:21:59.692900
[0m15:21:59.694900 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:21:59.696900 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:21:59.702919 [info ] [Thread-1 (]: 3 of 4 PASS order_dates_in_the_past ............................................ [[32mPASS[0m in 0.93s]
[0m15:21:59.706020 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:21:59.707922 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:21:59.709900 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:21:59.711903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:21:59.713905 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:21:59.740911 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:21:59.743912 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:21:59.715905 => 15:21:59.742932
[0m15:21:59.745915 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:21:59.758920 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:21:59.761924 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:21:59.763914 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:21:59.764915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:00.469092 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:22:00.470095 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:22:00.472095 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:22:00.479213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:22:00.483215 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:21:59.746918 => 15:22:00.482097
[0m15:22:00.484237 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:22:00.487099 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:22:00.491100 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.78s]
[0m15:22:00.494102 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:22:00.497221 [debug] [MainThread]: Using mysql connection "master"
[0m15:22:00.498220 [debug] [MainThread]: On master: BEGIN
[0m15:22:00.499220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:01.151266 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:22:01.153292 [debug] [MainThread]: On master: COMMIT
[0m15:22:01.154387 [debug] [MainThread]: Using mysql connection "master"
[0m15:22:01.155412 [debug] [MainThread]: On master: COMMIT
[0m15:22:01.158269 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:22:01.159268 [debug] [MainThread]: On master: Close
[0m15:22:01.163270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:01.164269 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:22:01.165270 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m15:22:01.166270 [info ] [MainThread]: 
[0m15:22:01.168271 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m15:22:01.173272 [debug] [MainThread]: Command end result
[0m15:22:01.211282 [info ] [MainThread]: 
[0m15:22:01.213283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:01.215283 [info ] [MainThread]: 
[0m15:22:01.218426 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:22:01.226285 [debug] [MainThread]: Command `dbt test` succeeded at 15:22:01.225286 after 7.52 seconds
[0m15:22:01.227285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7DC0C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7FADFDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7FADE480>]}
[0m15:22:01.228284 [debug] [MainThread]: Flushing usage events
[0m15:46:24.317070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6B88FA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6B88FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6B88F110>]}


============================== 15:46:24.331074 | dbaff9dd-2c5a-4bf5-b523-0bc9a7282ca8 ==============================
[0m15:46:24.331074 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:46:24.333073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:46:25.006244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbaff9dd-2c5a-4bf5-b523-0bc9a7282ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6B8E8110>]}
[0m15:46:25.277309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbaff9dd-2c5a-4bf5-b523-0bc9a7282ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6BC47500>]}
[0m15:46:25.279425 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:46:25.311318 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:46:25.505378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:46:25.507371 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:46:25.509371 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_customers.yml
[0m15:46:26.362724 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two tests with the name "not_null_stg_orders_customer_id" defined on column "customer_id" in "models.stg_orders".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (models\staging\stg_orders.yml)
  - test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (models\staging\stg_orders.yml)
[0m15:46:26.372706 [debug] [MainThread]: Command `dbt test` failed at 15:46:26.372706 after 2.50 seconds
[0m15:46:26.374610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6B6AF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6BE09370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6BE67710>]}
[0m15:46:26.376594 [debug] [MainThread]: Flushing usage events
[0m15:47:26.810163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C949FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C907DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C949E1E0>]}


============================== 15:47:26.821166 | 9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d ==============================
[0m15:47:26.821166 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:47:26.823283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:27.431466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C94FC320>]}
[0m15:47:27.707392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9363230>]}
[0m15:47:27.709521 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:47:27.737423 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:47:27.919568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:47:27.921443 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_customers.yml
[0m15:47:27.923570 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:47:28.820670 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:47:28.837676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CAE901D0>]}
[0m15:47:28.871681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9B8A5A0>]}
[0m15:47:28.873824 [info ] [MainThread]: Found 2 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:47:28.875685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9D46ED0>]}
[0m15:47:28.885687 [info ] [MainThread]: 
[0m15:47:28.888802 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:47:28.891692 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:47:28.933700 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:47:28.934822 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:47:28.935700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:29.620874 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:29.622875 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:47:29.623876 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:47:29.628874 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:47:29.633875 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:47:29.635875 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:47:29.652881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9628ea24-78b6-4e8c-b62f-de4ebc1c6d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CAE03920>]}
[0m15:47:29.654881 [debug] [MainThread]: Using mysql connection "master"
[0m15:47:29.656887 [debug] [MainThread]: On master: BEGIN
[0m15:47:29.658882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:30.518616 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:30.519732 [debug] [MainThread]: On master: COMMIT
[0m15:47:30.521731 [debug] [MainThread]: Using mysql connection "master"
[0m15:47:30.522734 [debug] [MainThread]: On master: COMMIT
[0m15:47:30.525616 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:47:30.526615 [debug] [MainThread]: On master: Close
[0m15:47:30.531619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:47:30.534151 [info ] [MainThread]: 
[0m15:47:30.546140 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:47:30.548140 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:47:30.552142 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:47:30.554142 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:47:30.608154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:47:30.615157 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:47:30.555143 => 15:47:30.610155
[0m15:47:30.617156 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:47:30.668170 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:47:30.671169 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:47:30.672169 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:47:30.673308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:31.346695 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:31.348815 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:47:31.349697 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:47:31.353695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:31.359843 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:47:30.618290 => 15:47:31.358817
[0m15:47:31.361700 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:47:31.363701 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:47:31.369845 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.82s]
[0m15:47:31.371704 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:47:31.373703 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:47:31.374704 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:47:31.378709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:47:31.381707 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:47:31.401710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:47:31.404710 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:47:31.382732 => 15:47:31.403708
[0m15:47:31.406711 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:47:31.417716 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:47:31.420714 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:47:31.421714 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:47:31.422850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.092931 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:32.094066 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:47:32.095930 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:47:32.099925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:32.104067 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:47:31.407747 => 15:47:32.103070
[0m15:47:32.105928 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:47:32.107930 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:47:32.114072 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.74s]
[0m15:47:32.116930 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:47:32.117935 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:47:32.120027 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m15:47:32.122958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:47:32.124938 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:47:32.141850 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:47:32.147730 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 15:47:32.125941 => 15:47:32.146728
[0m15:47:32.148730 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:47:32.157737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:47:32.164735 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:47:32.166736 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:47:32.168850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:32.833007 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:32.833987 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:47:32.835862 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m15:47:32.896877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:32.900878 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 15:47:32.149731 => 15:47:32.899878
[0m15:47:32.901879 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:47:32.904881 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:47:32.909885 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.79s]
[0m15:47:32.912885 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:47:32.914883 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:47:32.916883 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:47:32.918884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:47:32.920885 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:47:32.937899 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:47:32.940891 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (compile): 15:47:32.921886 => 15:47:32.939893
[0m15:47:32.942890 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:47:32.953893 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:47:32.957893 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:47:32.958894 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:47:32.963896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:33.630959 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:33.631959 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:47:33.632959 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_id
from `my_dbt_db`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m15:47:33.699974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:33.703979 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (execute): 15:47:32.945897 => 15:47:33.702977
[0m15:47:33.705980 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:47:33.707978 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:47:33.713122 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.79s]
[0m15:47:33.715981 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:47:33.716979 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca
[0m15:47:33.718999 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_ordered_at ............................... [RUN]
[0m15:47:33.721983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca)
[0m15:47:33.723984 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca
[0m15:47:33.740128 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:47:33.745988 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca (compile): 15:47:33.725984 => 15:47:33.742988
[0m15:47:33.748123 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca
[0m15:47:33.756010 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:47:33.767018 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:47:33.769129 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca: BEGIN
[0m15:47:33.770128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:34.430158 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:34.431163 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca"
[0m15:47:34.433161 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select ordered_at
from `my_dbt_db`.`stg_orders`
where ordered_at is null



      
    ) dbt_internal_test
[0m15:47:34.436676 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1054 (42S22): Unknown column 'ordered_at' in 'field list'
[0m15:47:34.437774 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca: ROLLBACK
[0m15:47:34.440677 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca (execute): 15:47:33.748123 => 15:47:34.439796
[0m15:47:34.441678 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca: Close
[0m15:47:34.463804 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_ordered_at (models\staging\stg_orders.yml)
  1054 (42S22): Unknown column 'ordered_at' in 'field list'
  compiled Code at target\run\dbt_challenge\models\staging\stg_orders.yml\not_null_stg_orders_ordered_at.sql
[0m15:47:34.465681 [error] [Thread-1 (]: 5 of 9 ERROR not_null_stg_orders_ordered_at .................................... [[31mERROR[0m in 0.74s]
[0m15:47:34.468682 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca
[0m15:47:34.470798 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:47:34.473817 [info ] [Thread-1 (]: 6 of 9 START test order_dates_in_the_past ...................................... [RUN]
[0m15:47:34.478691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_ordered_at.ed431172ca, now test.dbt_challenge.order_dates_in_the_past)
[0m15:47:34.481686 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:47:34.490691 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:47:34.500694 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:47:34.483688 => 15:47:34.492689
[0m15:47:34.501810 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:47:34.508695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:47:34.515721 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:47:34.518696 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:47:34.519697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:35.185369 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:35.186368 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:47:35.188370 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:47:35.304400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:35.310399 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:47:34.502831 => 15:47:35.309397
[0m15:47:35.312401 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:47:35.314402 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:47:35.319525 [info ] [Thread-1 (]: 6 of 9 PASS order_dates_in_the_past ............................................ [[32mPASS[0m in 0.84s]
[0m15:47:35.322401 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:47:35.323527 [debug] [Thread-1 (]: Began running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:47:35.325403 [info ] [Thread-1 (]: 7 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:47:35.329408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:47:35.330405 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:47:35.349413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:47:35.352412 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 15:47:35.331405 => 15:47:35.351410
[0m15:47:35.354413 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:47:35.362415 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:47:35.367419 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:47:35.369415 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:47:35.370414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:36.021578 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:36.022582 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:47:36.024580 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `my_dbt_db`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `my_dbt_db`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:47:36.183620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:36.193646 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 15:47:35.355413 => 15:47:36.192624
[0m15:47:36.195624 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:47:36.197624 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:47:36.201625 [info ] [Thread-1 (]: 7 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.87s]
[0m15:47:36.203624 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:47:36.205625 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:47:36.206626 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:47:36.209629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:47:36.211631 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:47:36.233744 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:47:36.237635 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:47:36.213629 => 15:47:36.236631
[0m15:47:36.238728 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:47:36.249638 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:47:36.251637 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:47:36.253637 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:47:36.254638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:36.916806 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:36.918810 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:47:36.919809 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:47:36.928808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:47:36.931809 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:47:36.239633 => 15:47:36.931809
[0m15:47:36.933809 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:47:36.935811 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:47:36.939958 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.73s]
[0m15:47:36.943838 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:47:36.945813 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:47:36.946812 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:47:36.949814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_customers_customer_id.c7614daada, now test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a)
[0m15:47:36.951816 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:47:36.970823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:47:36.975821 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (compile): 15:47:36.951816 => 15:47:36.974819
[0m15:47:36.979822 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:47:36.987824 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:47:36.991824 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:47:36.995848 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:47:36.998829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:37.908054 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:37.912058 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:47:37.914055 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:47:38.440187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:47:38.446186 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (execute): 15:47:36.980823 => 15:47:38.445187
[0m15:47:38.448187 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:47:38.450186 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:47:38.455191 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.51s]
[0m15:47:38.458193 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:47:38.463193 [debug] [MainThread]: Using mysql connection "master"
[0m15:47:38.464191 [debug] [MainThread]: On master: BEGIN
[0m15:47:38.466192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:39.270393 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:47:39.271396 [debug] [MainThread]: On master: COMMIT
[0m15:47:39.272396 [debug] [MainThread]: Using mysql connection "master"
[0m15:47:39.273396 [debug] [MainThread]: On master: COMMIT
[0m15:47:39.275398 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:47:39.278399 [debug] [MainThread]: On master: Close
[0m15:47:39.283402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:39.285399 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:47:39.286401 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:47:39.288402 [info ] [MainThread]: 
[0m15:47:39.290401 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m15:47:39.301404 [debug] [MainThread]: Command end result
[0m15:47:39.338414 [info ] [MainThread]: 
[0m15:47:39.340414 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:47:39.344427 [info ] [MainThread]: 
[0m15:47:39.349416 [error] [MainThread]:   Database Error in test not_null_stg_orders_ordered_at (models\staging\stg_orders.yml)
  1054 (42S22): Unknown column 'ordered_at' in 'field list'
  compiled Code at target\run\dbt_challenge\models\staging\stg_orders.yml\not_null_stg_orders_ordered_at.sql
[0m15:47:39.354420 [info ] [MainThread]: 
[0m15:47:39.365420 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:47:39.370556 [debug] [MainThread]: Command `dbt test` failed at 15:47:39.370556 after 12.89 seconds
[0m15:47:39.373423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C905C470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C92E8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C92EA510>]}
[0m15:47:39.380424 [debug] [MainThread]: Flushing usage events
[0m15:48:03.142453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92C0F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92C0E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92C0DC40>]}


============================== 15:48:03.153458 | a4572a5c-cc71-43a1-8df9-0a356abcc8e0 ==============================
[0m15:48:03.153458 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:48:03.156456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:48:03.768726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9305DD90>]}
[0m15:48:04.045681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92C6C5F0>]}
[0m15:48:04.048803 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:48:04.075688 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:48:04.249729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:04.251733 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:48:05.191969 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:48:05.214097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE94514DD0>]}
[0m15:48:05.246984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE9323E510>]}
[0m15:48:05.247983 [info ] [MainThread]: Found 2 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:48:05.251020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE94553AD0>]}
[0m15:48:05.258120 [info ] [MainThread]: 
[0m15:48:05.262988 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:48:05.269988 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:48:05.312090 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:48:05.313090 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:48:05.314094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:06.013176 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:06.015296 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:48:06.016322 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:48:06.022178 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:48:06.026184 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:48:06.028181 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:48:06.039182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4572a5c-cc71-43a1-8df9-0a356abcc8e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE934A3C50>]}
[0m15:48:06.040180 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:06.041179 [debug] [MainThread]: On master: BEGIN
[0m15:48:06.042180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:06.819376 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:06.821377 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.822378 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:06.823375 [debug] [MainThread]: On master: COMMIT
[0m15:48:06.825377 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:48:06.827377 [debug] [MainThread]: On master: Close
[0m15:48:06.831514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:06.833380 [info ] [MainThread]: 
[0m15:48:06.843517 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:06.845382 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:48:06.849389 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:48:06.851385 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:06.908398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:06.912402 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:48:06.853385 => 15:48:06.911410
[0m15:48:06.913399 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:06.959412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:06.963413 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:06.964416 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:48:06.965413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:07.630696 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:07.631695 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:07.632695 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:48:07.636697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:07.641841 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:48:06.915400 => 15:48:07.641841
[0m15:48:07.643841 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:48:07.645699 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:48:07.650700 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.80s]
[0m15:48:07.652663 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:07.655666 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:07.656664 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:48:07.660668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:48:07.661668 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:07.679668 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:07.682669 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:48:07.663667 => 15:48:07.681670
[0m15:48:07.683668 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:07.696685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:07.700792 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:07.701674 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:48:07.702812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:08.359835 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:08.360976 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:08.361834 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:48:08.366956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:08.371839 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:48:07.684671 => 15:48:08.370838
[0m15:48:08.372838 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:48:08.374959 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:48:08.379958 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.72s]
[0m15:48:08.382842 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:08.383842 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:08.385841 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m15:48:08.389844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:48:08.391846 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:08.409847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:08.412846 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 15:48:08.392844 => 15:48:08.411968
[0m15:48:08.413848 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:08.422852 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:08.428852 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:08.429853 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:48:08.430854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:09.084019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:09.086020 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:09.088022 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m15:48:09.153179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:09.158038 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 15:48:08.414848 => 15:48:09.157037
[0m15:48:09.159036 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:48:09.161169 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:48:09.166040 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.78s]
[0m15:48:09.169040 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:09.171043 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:09.173163 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:48:09.176042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:48:09.178068 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:09.195171 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:09.198046 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (compile): 15:48:09.179041 => 15:48:09.197045
[0m15:48:09.199164 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:09.210054 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:09.213047 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:09.214163 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:48:09.215171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:09.891336 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:09.892362 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:09.893364 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_id
from `my_dbt_db`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m15:48:09.958235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:09.962357 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (execute): 15:48:09.200171 => 15:48:09.961383
[0m15:48:09.963382 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:48:09.966359 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:48:09.971246 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.80s]
[0m15:48:09.973243 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:09.975303 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d
[0m15:48:09.977240 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_ordered_date ............................. [RUN]
[0m15:48:09.980268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d)
[0m15:48:09.982244 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d
[0m15:48:09.997250 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d"
[0m15:48:10.000248 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d (compile): 15:48:09.983246 => 15:48:10.000248
[0m15:48:10.002249 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d
[0m15:48:10.010252 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d"
[0m15:48:10.015256 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d"
[0m15:48:10.017254 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d: BEGIN
[0m15:48:10.018253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:10.685429 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:10.687424 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d"
[0m15:48:10.689562 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select ordered_date
from `my_dbt_db`.`stg_orders`
where ordered_date is null



      
    ) dbt_internal_test
[0m15:48:10.693429 [debug] [Thread-1 (]: mysql adapter: MySQL error: 1054 (42S22): Unknown column 'ordered_date' in 'field list'
[0m15:48:10.695424 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d: ROLLBACK
[0m15:48:10.697427 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d (execute): 15:48:10.002249 => 15:48:10.697427
[0m15:48:10.699567 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d: Close
[0m15:48:10.720431 [debug] [Thread-1 (]: Database Error in test not_null_stg_orders_ordered_date (models\staging\stg_orders.yml)
  1054 (42S22): Unknown column 'ordered_date' in 'field list'
  compiled Code at target\run\dbt_challenge\models\staging\stg_orders.yml\not_null_stg_orders_ordered_date.sql
[0m15:48:10.722572 [error] [Thread-1 (]: 5 of 9 ERROR not_null_stg_orders_ordered_date .................................. [[31mERROR[0m in 0.74s]
[0m15:48:10.725431 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d
[0m15:48:10.726525 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:48:10.729576 [info ] [Thread-1 (]: 6 of 9 START test order_dates_in_the_past ...................................... [RUN]
[0m15:48:10.733439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_ordered_date.925362d84d, now test.dbt_challenge.order_dates_in_the_past)
[0m15:48:10.734440 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:48:10.746442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:10.749437 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:48:10.739437 => 15:48:10.748439
[0m15:48:10.750438 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:48:10.761442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:10.764442 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:10.766585 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:48:10.767442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:11.534750 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:11.536636 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:11.537637 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:48:11.656691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:11.660671 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:48:10.751580 => 15:48:11.659667
[0m15:48:11.661671 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:48:11.663676 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:48:11.668670 [info ] [Thread-1 (]: 6 of 9 PASS order_dates_in_the_past ............................................ [[32mPASS[0m in 0.94s]
[0m15:48:11.671779 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:48:11.672811 [debug] [Thread-1 (]: Began running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:48:11.674788 [info ] [Thread-1 (]: 7 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:48:11.678673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:48:11.679672 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:48:11.698679 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:48:11.701678 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 15:48:11.680673 => 15:48:11.700677
[0m15:48:11.705679 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:48:11.726684 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:48:11.729685 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:48:11.731685 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:48:11.732685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:12.395852 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:12.397857 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:48:12.398994 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `my_dbt_db`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `my_dbt_db`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:48:12.560893 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:12.565033 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 15:48:11.705679 => 15:48:12.564034
[0m15:48:12.567020 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:48:12.569897 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:48:12.575035 [info ] [Thread-1 (]: 7 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.90s]
[0m15:48:12.577900 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:48:12.578900 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:48:12.579902 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:48:12.583388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:48:12.584389 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:48:12.611395 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:48:12.659399 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:48:12.587389 => 15:48:12.658405
[0m15:48:12.660399 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:48:12.667402 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:48:12.671402 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:48:12.672513 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:48:12.673541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:13.302811 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:13.303817 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:48:13.305814 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:13.311937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:13.315941 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:48:12.661398 => 15:48:13.314957
[0m15:48:13.316815 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:48:13.319816 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:48:13.324937 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.74s]
[0m15:48:13.327817 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:48:13.328961 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:48:13.330962 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:48:13.334278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_customers_customer_id.c7614daada, now test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a)
[0m15:48:13.335245 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:48:13.351368 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:48:13.357242 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (compile): 15:48:13.339252 => 15:48:13.355241
[0m15:48:13.359243 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:48:13.365536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:48:13.368531 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:48:13.372553 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:48:13.374529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:14.044132 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:14.046135 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:48:14.048015 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:48:14.357129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:14.360252 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (execute): 15:48:13.359243 => 15:48:14.360252
[0m15:48:14.361278 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:48:14.364251 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:48:14.369131 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.04s]
[0m15:48:14.372256 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:48:14.376140 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:14.377135 [debug] [MainThread]: On master: BEGIN
[0m15:48:14.378137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:15.183342 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:15.184463 [debug] [MainThread]: On master: COMMIT
[0m15:48:15.186344 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:15.187455 [debug] [MainThread]: On master: COMMIT
[0m15:48:15.191461 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:48:15.192484 [debug] [MainThread]: On master: Close
[0m15:48:15.197346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:15.198480 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:48:15.199465 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:48:15.201488 [info ] [MainThread]: 
[0m15:48:15.204358 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 9.94 seconds (9.94s).
[0m15:48:15.211345 [debug] [MainThread]: Command end result
[0m15:48:15.237352 [info ] [MainThread]: 
[0m15:48:15.239354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:48:15.241355 [info ] [MainThread]: 
[0m15:48:15.244356 [error] [MainThread]:   Database Error in test not_null_stg_orders_ordered_date (models\staging\stg_orders.yml)
  1054 (42S22): Unknown column 'ordered_date' in 'field list'
  compiled Code at target\run\dbt_challenge\models\staging\stg_orders.yml\not_null_stg_orders_ordered_date.sql
[0m15:48:15.248371 [info ] [MainThread]: 
[0m15:48:15.251476 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:48:15.260357 [debug] [MainThread]: Command `dbt test` failed at 15:48:15.257359 after 12.42 seconds
[0m15:48:15.262359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92BDFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92BDF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE92BDF8F0>]}
[0m15:48:15.263501 [debug] [MainThread]: Flushing usage events
[0m15:48:51.658052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CE6CEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CE6CF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CE6E7B0>]}


============================== 15:48:51.671162 | 5969266c-05e4-4c59-bd5c-536520488155 ==============================
[0m15:48:51.671162 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:48:51.673064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:52.308223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3D09EE10>]}
[0m15:48:52.579293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CE6CB00>]}
[0m15:48:52.582291 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:48:52.609439 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:48:52.789345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:52.791347 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:48:53.714492 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:48:53.730499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3E8522D0>]}
[0m15:48:53.767505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3D5064B0>]}
[0m15:48:53.769646 [info ] [MainThread]: Found 2 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:48:53.771507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3D783B00>]}
[0m15:48:53.777659 [info ] [MainThread]: 
[0m15:48:53.782808 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:48:53.786667 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:48:53.822808 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:48:53.823809 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:48:53.824808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:54.552858 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:54.553859 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:48:54.554860 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:48:54.559861 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:48:54.564002 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:48:54.565861 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:48:54.576016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5969266c-05e4-4c59-bd5c-536520488155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3D6F2EA0>]}
[0m15:48:54.578016 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:54.579018 [debug] [MainThread]: On master: BEGIN
[0m15:48:54.580157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:55.401219 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:55.402219 [debug] [MainThread]: On master: COMMIT
[0m15:48:55.403219 [debug] [MainThread]: Using mysql connection "master"
[0m15:48:55.404219 [debug] [MainThread]: On master: COMMIT
[0m15:48:55.407236 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:48:55.409222 [debug] [MainThread]: On master: Close
[0m15:48:55.414340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:55.416222 [info ] [MainThread]: 
[0m15:48:55.426337 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:55.429229 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:48:55.432226 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:48:55.433224 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:55.491363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:55.499243 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:48:55.437231 => 15:48:55.493369
[0m15:48:55.500243 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:55.547257 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:55.551259 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:55.552259 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:48:55.554257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:56.227428 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:56.229428 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:48:56.230426 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:48:56.234430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:56.240433 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:48:55.501244 => 15:48:56.239430
[0m15:48:56.241431 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:48:56.243434 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:48:56.248550 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.82s]
[0m15:48:56.252573 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:48:56.253575 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:56.255433 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:48:56.258436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:48:56.261439 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:56.277454 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:56.282442 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:48:56.262438 => 15:48:56.281443
[0m15:48:56.284441 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:56.292442 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:56.298446 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:56.301448 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:48:56.302533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:56.970613 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:56.971613 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:48:56.973614 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:48:56.977616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:56.981615 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:48:56.287445 => 15:48:56.980614
[0m15:48:56.982616 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:48:56.983617 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:48:56.988619 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.73s]
[0m15:48:56.991619 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:48:56.992619 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:56.995619 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m15:48:56.998621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:48:56.999623 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:57.016626 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:57.019628 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 15:48:57.001622 => 15:48:57.018625
[0m15:48:57.020627 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:57.031633 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:57.035631 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:57.036629 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:48:57.037631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:57.693799 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:57.695908 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:48:57.696795 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m15:48:57.758811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:57.762936 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 15:48:57.021763 => 15:48:57.761933
[0m15:48:57.763932 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:48:57.766815 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:48:57.771815 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.77s]
[0m15:48:57.773815 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:48:57.775815 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:48:57.777818 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_orders_order_date ............................... [RUN]
[0m15:48:57.780820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb)
[0m15:48:57.782819 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:48:57.799823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:48:57.802825 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (compile): 15:48:57.783821 => 15:48:57.802825
[0m15:48:57.804825 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:48:57.813850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:48:57.818830 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:48:57.819837 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: BEGIN
[0m15:48:57.820828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:58.481762 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:58.482751 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:48:58.483749 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_date
from `my_dbt_db`.`stg_orders`
where order_date is null



      
    ) dbt_internal_test
[0m15:48:58.550766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:58.553768 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (execute): 15:48:57.805825 => 15:48:58.553768
[0m15:48:58.555766 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: ROLLBACK
[0m15:48:58.557768 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: Close
[0m15:48:58.562769 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_orders_order_date ..................................... [[32mPASS[0m in 0.78s]
[0m15:48:58.565775 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:48:58.567773 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:58.568772 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:48:58.571775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:48:58.573776 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:58.589987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:58.592847 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (compile): 15:48:58.574774 => 15:48:58.591849
[0m15:48:58.595851 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:58.601990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:58.605870 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:58.608854 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:48:58.612855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:59.281529 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:48:59.283530 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:48:59.284529 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_id
from `my_dbt_db`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m15:48:59.350547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:48:59.354551 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (execute): 15:48:58.596853 => 15:48:59.353549
[0m15:48:59.355549 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:48:59.357549 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:48:59.362549 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.79s]
[0m15:48:59.365551 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:48:59.367552 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:48:59.369552 [info ] [Thread-1 (]: 6 of 9 START test order_dates_in_the_past ...................................... [RUN]
[0m15:48:59.372555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_challenge.order_dates_in_the_past)
[0m15:48:59.374554 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:48:59.386556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:59.389558 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:48:59.375554 => 15:48:59.388558
[0m15:48:59.390556 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:48:59.399560 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:59.402561 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:48:59.405563 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:48:59.407563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:00.079731 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:49:00.080732 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:49:00.081731 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:49:00.198761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:49:00.202763 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:48:59.391558 => 15:49:00.201760
[0m15:49:00.203762 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:49:00.206764 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:49:00.211875 [info ] [Thread-1 (]: 6 of 9 PASS order_dates_in_the_past ............................................ [[32mPASS[0m in 0.84s]
[0m15:49:00.214900 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:49:00.215765 [debug] [Thread-1 (]: Began running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:49:00.217765 [info ] [Thread-1 (]: 7 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:49:00.220768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:49:00.222768 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:49:00.245781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:49:00.250774 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 15:49:00.223769 => 15:49:00.249778
[0m15:49:00.251775 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:49:00.266896 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:49:00.269781 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:49:00.270777 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:49:00.271916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:00.932947 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:49:00.933946 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:49:00.934949 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `my_dbt_db`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `my_dbt_db`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:49:01.094987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:49:01.099113 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 15:49:00.252909 => 15:49:01.098113
[0m15:49:01.100112 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:49:01.101995 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:49:01.107993 [info ] [Thread-1 (]: 7 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.89s]
[0m15:49:01.110994 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:49:01.111993 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:49:01.112993 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:49:01.116994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:49:01.117994 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:49:01.144003 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:49:01.150002 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:49:01.118995 => 15:49:01.149004
[0m15:49:01.152121 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:49:01.159123 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:49:01.166006 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:49:01.167005 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:49:01.169007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:01.941203 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:49:01.943200 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:49:01.946204 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:49:01.953203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:49:01.957209 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:49:01.153001 => 15:49:01.956205
[0m15:49:01.958205 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:49:01.961207 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:49:01.965206 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.85s]
[0m15:49:01.968318 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:49:01.970321 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:49:01.971334 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:49:01.974211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_customers_customer_id.c7614daada, now test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a)
[0m15:49:01.978211 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:49:01.992352 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:49:01.999215 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (compile): 15:49:01.981211 => 15:49:01.999215
[0m15:49:02.001327 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:49:02.008219 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:49:02.014221 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:49:02.016223 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:49:02.017219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:02.688389 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:49:02.690391 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:49:02.691391 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:49:03.001470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:49:03.005470 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (execute): 15:49:02.001327 => 15:49:03.004466
[0m15:49:03.007469 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:49:03.009480 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:49:03.014597 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.04s]
[0m15:49:03.017473 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:49:03.021595 [debug] [MainThread]: Using mysql connection "master"
[0m15:49:03.022595 [debug] [MainThread]: On master: BEGIN
[0m15:49:03.023595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:03.816672 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:49:03.817821 [debug] [MainThread]: On master: COMMIT
[0m15:49:03.818819 [debug] [MainThread]: Using mysql connection "master"
[0m15:49:03.819817 [debug] [MainThread]: On master: COMMIT
[0m15:49:03.821675 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:49:03.822675 [debug] [MainThread]: On master: Close
[0m15:49:03.828678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:03.829679 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:49:03.830679 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:49:03.831679 [info ] [MainThread]: 
[0m15:49:03.833677 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m15:49:03.839677 [debug] [MainThread]: Command end result
[0m15:49:03.870766 [info ] [MainThread]: 
[0m15:49:03.872687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:03.873717 [info ] [MainThread]: 
[0m15:49:03.878689 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:49:03.883706 [debug] [MainThread]: Command `dbt test` succeeded at 15:49:03.882691 after 12.54 seconds
[0m15:49:03.884687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CC76A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3CECC170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C3E9324B0>]}
[0m15:49:03.886689 [debug] [MainThread]: Flushing usage events
[0m15:50:01.559125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867AFC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867AFD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867AFD820>]}


============================== 15:50:01.571128 | a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec ==============================
[0m15:50:01.571128 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:50:01.573130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:02.212289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867B58170>]}
[0m15:50:02.506360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238676BC440>]}
[0m15:50:02.509363 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:50:02.536369 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:50:02.723512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:02.725419 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:50:03.621645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:50:03.643649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238683DCD10>]}
[0m15:50:03.685800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386816E9F0>]}
[0m15:50:03.686660 [info ] [MainThread]: Found 2 models, 10 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:50:03.688664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386806F920>]}
[0m15:50:03.694780 [info ] [MainThread]: 
[0m15:50:03.699734 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:50:03.707664 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:50:03.745674 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:50:03.748686 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:50:03.750677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:04.429846 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:04.430848 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:50:04.431849 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:50:04.437951 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:50:04.440994 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:50:04.442871 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:50:04.454974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e9921c-b3ae-440f-9b4a-e72c0fdd13ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238694A87A0>]}
[0m15:50:04.455975 [debug] [MainThread]: Using mysql connection "master"
[0m15:50:04.457973 [debug] [MainThread]: On master: BEGIN
[0m15:50:04.458999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:05.141034 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:05.142171 [debug] [MainThread]: On master: COMMIT
[0m15:50:05.143169 [debug] [MainThread]: Using mysql connection "master"
[0m15:50:05.144044 [debug] [MainThread]: On master: COMMIT
[0m15:50:05.148030 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:50:05.149030 [debug] [MainThread]: On master: Close
[0m15:50:05.153032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:05.155030 [info ] [MainThread]: 
[0m15:50:05.163173 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:50:05.165031 [info ] [Thread-1 (]: 1 of 10 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m15:50:05.169037 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:50:05.170036 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:50:05.220047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:50:05.224051 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:50:05.172037 => 15:50:05.223048
[0m15:50:05.226048 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:50:05.276063 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:50:05.279062 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:50:05.282155 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:50:05.283205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:05.943342 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:05.944369 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:50:05.945228 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:50:05.950229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:05.955233 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:50:05.227050 => 15:50:05.955233
[0m15:50:05.957228 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:50:05.959233 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:50:05.964237 [info ] [Thread-1 (]: 1 of 10 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.80s]
[0m15:50:05.967233 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:50:05.968373 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:50:05.970374 [info ] [Thread-1 (]: 2 of 10 START test not_null_stg_customers_customer_name ........................ [RUN]
[0m15:50:05.973249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:50:05.977239 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:50:05.993239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:50:06.001245 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:50:05.979259 => 15:50:05.995240
[0m15:50:06.004244 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:50:06.011379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:50:06.018245 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:50:06.020245 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:50:06.021246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:06.678409 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:06.680408 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:50:06.681409 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:50:06.686423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:06.690529 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:50:06.005242 => 15:50:06.689530
[0m15:50:06.691530 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:50:06.694531 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:50:06.699532 [info ] [Thread-1 (]: 2 of 10 PASS not_null_stg_customers_customer_name .............................. [[32mPASS[0m in 0.73s]
[0m15:50:06.702532 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:50:06.704531 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:50:06.705414 [info ] [Thread-1 (]: 3 of 10 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m15:50:06.709415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:50:06.711415 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:50:06.727437 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:50:06.732422 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 15:50:06.713425 => 15:50:06.731428
[0m15:50:06.733420 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:50:06.740421 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:50:06.744428 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:50:06.750440 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:50:06.752428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:07.412672 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:07.414594 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:50:07.416592 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m15:50:07.482610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:07.486611 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 15:50:06.734539 => 15:50:07.485612
[0m15:50:07.487612 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:50:07.489612 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:50:07.493612 [info ] [Thread-1 (]: 3 of 10 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.79s]
[0m15:50:07.497616 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:50:07.499615 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:50:07.500733 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_orders_order_date .............................. [RUN]
[0m15:50:07.503620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb)
[0m15:50:07.506616 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:50:07.523621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:50:07.527622 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (compile): 15:50:07.509616 => 15:50:07.525621
[0m15:50:07.528623 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:50:07.539625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:50:07.542625 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:50:07.544625 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: BEGIN
[0m15:50:07.547629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:08.201790 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:08.202934 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:50:08.203907 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_date
from `my_dbt_db`.`stg_orders`
where order_date is null



      
    ) dbt_internal_test
[0m15:50:08.267808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:08.270949 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (execute): 15:50:07.531622 => 15:50:08.270949
[0m15:50:08.272951 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: ROLLBACK
[0m15:50:08.274928 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: Close
[0m15:50:08.279840 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_orders_order_date .................................... [[32mPASS[0m in 0.78s]
[0m15:50:08.282814 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:50:08.283813 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:50:08.285815 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_orders_order_id ................................ [RUN]
[0m15:50:08.288815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:50:08.290929 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:50:08.308935 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:50:08.311819 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (compile): 15:50:08.291828 => 15:50:08.310841
[0m15:50:08.315826 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:50:08.323960 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:50:08.326821 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:50:08.328938 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:50:08.331824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:09.018999 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:09.020141 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:50:09.021141 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_id
from `my_dbt_db`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m15:50:09.085014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:09.089016 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (execute): 15:50:08.317821 => 15:50:09.089016
[0m15:50:09.091014 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:50:09.093016 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:50:09.098018 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.81s]
[0m15:50:09.102019 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:50:09.103026 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:50:09.104019 [info ] [Thread-1 (]: 6 of 10 START test order_dates_in_the_past ..................................... [RUN]
[0m15:50:09.108021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_challenge.order_dates_in_the_past)
[0m15:50:09.110022 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:50:09.121140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:50:09.124023 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:50:09.111023 => 15:50:09.123034
[0m15:50:09.126025 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:50:09.138026 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:50:09.141028 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:50:09.143028 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:50:09.144029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:09.802327 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:09.803321 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:50:09.805197 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:50:09.921347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:09.925227 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:50:09.127026 => 15:50:09.924369
[0m15:50:09.927230 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:50:09.928226 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:50:09.934231 [info ] [Thread-1 (]: 6 of 10 PASS order_dates_in_the_past ........................................... [[32mPASS[0m in 0.83s]
[0m15:50:09.937232 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:50:09.938231 [debug] [Thread-1 (]: Began running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:50:09.940234 [info ] [Thread-1 (]: 7 of 10 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:50:09.943233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:50:09.945231 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:50:09.965236 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:50:09.970239 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 15:50:09.947234 => 15:50:09.969237
[0m15:50:09.971260 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:50:09.986243 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:50:09.990245 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:50:09.991344 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:50:09.992369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:10.641406 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:10.642411 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:50:10.644549 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `my_dbt_db`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `my_dbt_db`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:50:10.811449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:10.816451 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 15:50:09.972240 => 15:50:10.815457
[0m15:50:10.817597 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:50:10.820570 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:50:10.824455 [info ] [Thread-1 (]: 7 of 10 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.88s]
[0m15:50:10.827455 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:50:10.830480 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:50:10.831597 [info ] [Thread-1 (]: 8 of 10 START test unique_stg_customers_customer_id ............................ [RUN]
[0m15:50:10.834456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:50:10.836456 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:50:10.866463 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:50:10.871464 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:50:10.837459 => 15:50:10.870463
[0m15:50:10.872463 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:50:10.883470 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:50:10.887470 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:50:10.889468 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:50:10.890470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:11.550636 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:11.551760 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:50:11.552759 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:11.559635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:11.564641 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:50:10.873598 => 15:50:11.563642
[0m15:50:11.565641 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:50:11.567642 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:50:11.572764 [info ] [Thread-1 (]: 8 of 10 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.74s]
[0m15:50:11.575644 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:50:11.577643 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_customer_id.f138e21520
[0m15:50:11.579646 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_orders_customer_id ............................... [RUN]
[0m15:50:11.582645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_customers_customer_id.c7614daada, now test.dbt_challenge.unique_stg_orders_customer_id.f138e21520)
[0m15:50:11.584644 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_customer_id.f138e21520
[0m15:50:11.602650 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_customer_id.f138e21520"
[0m15:50:11.626836 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_customer_id.f138e21520 (compile): 15:50:11.587646 => 15:50:11.625834
[0m15:50:11.629835 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_customer_id.f138e21520
[0m15:50:11.638932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_customer_id.f138e21520"
[0m15:50:11.641839 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_customer_id.f138e21520"
[0m15:50:11.643918 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_customer_id.f138e21520: BEGIN
[0m15:50:11.646841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:12.335011 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:12.337012 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_customer_id.f138e21520"
[0m15:50:12.338010 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_customer_id.f138e21520: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_customer_id.f138e21520"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:12.604079 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:12.609083 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_customer_id.f138e21520 (execute): 15:50:11.631836 => 15:50:12.608079
[0m15:50:12.610081 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_customer_id.f138e21520: ROLLBACK
[0m15:50:12.612080 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_customer_id.f138e21520: Close
[0m15:50:12.618079 [error] [Thread-1 (]: 9 of 10 FAIL 920 unique_stg_orders_customer_id ................................. [[31mFAIL 920[0m in 1.04s]
[0m15:50:12.620082 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_customer_id.f138e21520
[0m15:50:12.622085 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:50:12.623085 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_orders_order_id ................................. [RUN]
[0m15:50:12.626090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_orders_customer_id.f138e21520, now test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a)
[0m15:50:12.628088 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:50:12.643087 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:50:12.651093 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (compile): 15:50:12.630089 => 15:50:12.650088
[0m15:50:12.652090 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:50:12.659092 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:50:12.666094 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:50:12.669213 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:50:12.671237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:13.320259 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:13.321261 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:50:13.323258 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:50:13.620336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:50:13.623338 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (execute): 15:50:12.654091 => 15:50:13.622336
[0m15:50:13.624336 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:50:13.627338 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:50:13.632341 [info ] [Thread-1 (]: 10 of 10 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.01s]
[0m15:50:13.634338 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:50:13.638461 [debug] [MainThread]: Using mysql connection "master"
[0m15:50:13.639463 [debug] [MainThread]: On master: BEGIN
[0m15:50:13.640464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:14.321508 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:50:14.322512 [debug] [MainThread]: On master: COMMIT
[0m15:50:14.323511 [debug] [MainThread]: Using mysql connection "master"
[0m15:50:14.324512 [debug] [MainThread]: On master: COMMIT
[0m15:50:14.327513 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:50:14.329528 [debug] [MainThread]: On master: Close
[0m15:50:14.333633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:14.335519 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:50:14.336517 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:50:14.337514 [info ] [MainThread]: 
[0m15:50:14.339515 [info ] [MainThread]: Finished running 10 tests in 0 hours 0 minutes and 10.64 seconds (10.64s).
[0m15:50:14.345518 [debug] [MainThread]: Command end result
[0m15:50:14.368522 [info ] [MainThread]: 
[0m15:50:14.371524 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:14.373524 [info ] [MainThread]: 
[0m15:50:14.375526 [error] [MainThread]: [31mFailure in test unique_stg_orders_customer_id (models\staging\stg_orders.yml)[0m
[0m15:50:14.377525 [error] [MainThread]:   Got 920 results, configured to fail if != 0
[0m15:50:14.387528 [info ] [MainThread]: 
[0m15:50:14.389528 [info ] [MainThread]:   compiled Code at target\compiled\dbt_challenge\models\staging\stg_orders.yml\unique_stg_orders_customer_id.sql
[0m15:50:14.391528 [info ] [MainThread]: 
[0m15:50:14.394649 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m15:50:14.402534 [debug] [MainThread]: Command `dbt test` failed at 15:50:14.401538 after 13.27 seconds
[0m15:50:14.404534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867AFD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867ACF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023867ACFD10>]}
[0m15:50:14.408533 [debug] [MainThread]: Flushing usage events
[0m15:51:15.361459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BCDF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BCDF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BCDF5F0>]}


============================== 15:51:15.375461 | 4b5cb519-db9f-42e2-8ebb-f44b5e25f529 ==============================
[0m15:51:15.375461 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:51:15.377462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpvt\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\BigPapaProject\\GitHub\\dbt-challenge\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:16.008556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BE13F80>]}
[0m15:51:16.305511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BB16D20>]}
[0m15:51:16.308614 [info ] [MainThread]: Registered adapter: mysql=1.7.0
[0m15:51:16.343612 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:51:16.531662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:16.534662 [debug] [MainThread]: Partial parsing: updated file: dbt_challenge://models\staging\stg_orders.yml
[0m15:51:17.434443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_projet.staging
[0m15:51:17.450473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D6EE990>]}
[0m15:51:17.487315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6C382900>]}
[0m15:51:17.488437 [info ] [MainThread]: Found 2 models, 9 tests, 2 sources, 0 exposures, 0 metrics, 375 macros, 0 groups, 0 semantic models
[0m15:51:17.490318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BB16AB0>]}
[0m15:51:17.496321 [info ] [MainThread]: 
[0m15:51:17.502322 [debug] [MainThread]: Acquiring new mysql connection 'master'
[0m15:51:17.508324 [debug] [ThreadPool]: Acquiring new mysql connection 'list_None_my_dbt_db'
[0m15:51:17.547332 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:51:17.553333 [debug] [ThreadPool]: On list_None_my_dbt_db: BEGIN
[0m15:51:17.555445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:18.246606 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:18.247608 [debug] [ThreadPool]: Using mysql connection "list_None_my_dbt_db"
[0m15:51:18.249608 [debug] [ThreadPool]: On list_None_my_dbt_db: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "connection_name": "list_None_my_dbt_db"} */
select
      null as "database",
      table_name as name,
      table_schema as "schema",
      case when table_type = 'BASE TABLE' then 'table'
           when table_type = 'VIEW' then 'view'
           else table_type
      end as table_type
    from information_schema.tables
    where table_schema = 'my_dbt_db'
  
[0m15:51:18.254608 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m15:51:18.257610 [debug] [ThreadPool]: On list_None_my_dbt_db: ROLLBACK
[0m15:51:18.259721 [debug] [ThreadPool]: On list_None_my_dbt_db: Close
[0m15:51:18.270610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b5cb519-db9f-42e2-8ebb-f44b5e25f529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6C1F4E60>]}
[0m15:51:18.272612 [debug] [MainThread]: Using mysql connection "master"
[0m15:51:18.273617 [debug] [MainThread]: On master: BEGIN
[0m15:51:18.274614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:19.037194 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:19.038195 [debug] [MainThread]: On master: COMMIT
[0m15:51:19.039193 [debug] [MainThread]: Using mysql connection "master"
[0m15:51:19.040193 [debug] [MainThread]: On master: COMMIT
[0m15:51:19.042194 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:51:19.044196 [debug] [MainThread]: On master: Close
[0m15:51:19.048195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:19.051197 [info ] [MainThread]: 
[0m15:51:19.060196 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:51:19.061197 [info ] [Thread-1 (]: 1 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m15:51:19.068201 [debug] [Thread-1 (]: Acquiring new mysql connection 'test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m15:51:19.069200 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:51:19.123216 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:51:19.127215 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 15:51:19.071202 => 15:51:19.126214
[0m15:51:19.128216 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:51:19.173364 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:51:19.176225 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:51:19.177227 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:51:19.178364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:19.850399 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:19.851399 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:51:19.852399 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_customers`
where customer_id is null



      
    ) dbt_internal_test
[0m15:51:19.856399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:19.860400 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 15:51:19.129215 => 15:51:19.860400
[0m15:51:19.861401 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:51:19.863399 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:51:19.869542 [info ] [Thread-1 (]: 1 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.81s]
[0m15:51:19.872542 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:51:19.873542 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:51:19.875402 [info ] [Thread-1 (]: 2 of 9 START test not_null_stg_customers_customer_name ......................... [RUN]
[0m15:51:19.878404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60)
[0m15:51:19.880423 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:51:19.902412 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:51:19.906409 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (compile): 15:51:19.882406 => 15:51:19.905410
[0m15:51:19.907411 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:51:19.914554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:51:19.922415 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:51:19.923415 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m15:51:19.924418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:20.599586 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:20.600588 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"
[0m15:51:20.601709 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_name
from `my_dbt_db`.`stg_customers`
where customer_name is null



      
    ) dbt_internal_test
[0m15:51:20.605586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:20.610589 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60 (execute): 15:51:19.908527 => 15:51:20.609588
[0m15:51:20.611590 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m15:51:20.613592 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m15:51:20.619715 [info ] [Thread-1 (]: 2 of 9 PASS not_null_stg_customers_customer_name ............................... [[32mPASS[0m in 0.74s]
[0m15:51:20.622592 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60
[0m15:51:20.623590 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:51:20.625592 [info ] [Thread-1 (]: 3 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m15:51:20.628606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_customers_customer_name.5c92a78a60, now test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:51:20.635594 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:51:20.651599 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:51:20.654605 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 15:51:20.637596 => 15:51:20.653721
[0m15:51:20.656728 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:51:20.663603 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:51:20.672605 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:51:20.673604 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:51:20.674606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:21.337770 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:21.339772 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:51:21.340773 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select customer_id
from `my_dbt_db`.`stg_orders`
where customer_id is null



      
    ) dbt_internal_test
[0m15:51:21.407789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:21.411915 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 15:51:20.657601 => 15:51:21.410913
[0m15:51:21.412914 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:51:21.415793 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:51:21.420918 [info ] [Thread-1 (]: 3 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 0.79s]
[0m15:51:21.423915 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:51:21.424915 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:51:21.426795 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_orders_order_date ............................... [RUN]
[0m15:51:21.429795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb)
[0m15:51:21.432798 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:51:21.449810 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:51:21.453799 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (compile): 15:51:21.434796 => 15:51:21.453799
[0m15:51:21.455921 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:51:21.462944 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:51:21.467829 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:51:21.470805 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: BEGIN
[0m15:51:21.472803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:22.124970 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:22.125973 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"
[0m15:51:22.127974 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_date
from `my_dbt_db`.`stg_orders`
where order_date is null



      
    ) dbt_internal_test
[0m15:51:22.191991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:22.196021 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb (execute): 15:51:21.456867 => 15:51:22.194987
[0m15:51:22.196987 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: ROLLBACK
[0m15:51:22.199995 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb: Close
[0m15:51:22.203992 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_orders_order_date ..................................... [[32mPASS[0m in 0.78s]
[0m15:51:22.206993 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb
[0m15:51:22.208992 [debug] [Thread-1 (]: Began running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:51:22.210092 [info ] [Thread-1 (]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:51:22.212993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_date.2177a3e8bb, now test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:51:22.214996 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:51:22.229997 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:51:22.236999 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (compile): 15:51:22.216995 => 15:51:22.235997
[0m15:51:22.238119 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:51:22.244141 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:51:22.247000 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:51:22.251004 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:51:22.253004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:22.948178 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:22.949177 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:51:22.950179 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    



select order_id
from `my_dbt_db`.`stg_orders`
where order_id is null



      
    ) dbt_internal_test
[0m15:51:23.013118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:23.018238 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64 (execute): 15:51:22.239141 => 15:51:23.017119
[0m15:51:23.019238 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:51:23.021238 [debug] [Thread-1 (]: On test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:51:23.025239 [info ] [Thread-1 (]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.81s]
[0m15:51:23.028122 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64
[0m15:51:23.030214 [debug] [Thread-1 (]: Began running node test.dbt_challenge.order_dates_in_the_past
[0m15:51:23.033242 [info ] [Thread-1 (]: 6 of 9 START test order_dates_in_the_past ...................................... [RUN]
[0m15:51:23.037122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_challenge.order_dates_in_the_past)
[0m15:51:23.039128 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.order_dates_in_the_past
[0m15:51:23.049130 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:51:23.054130 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (compile): 15:51:23.040126 => 15:51:23.052128
[0m15:51:23.056128 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.order_dates_in_the_past
[0m15:51:23.062129 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.order_dates_in_the_past"
[0m15:51:23.067132 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:51:23.069131 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: BEGIN
[0m15:51:23.071136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:23.726360 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:23.728295 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.order_dates_in_the_past"
[0m15:51:23.729416 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.order_dates_in_the_past"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      with invalid_orders as (
    select *
    from `my_dbt_db`.`stg_orders`
    where order_date > current_date
)
select count(*)
from invalid_orders
having count(*) > 0
      
    ) dbt_internal_test
[0m15:51:23.843326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:23.848330 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.order_dates_in_the_past (execute): 15:51:23.057131 => 15:51:23.846327
[0m15:51:23.849329 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: ROLLBACK
[0m15:51:23.851333 [debug] [Thread-1 (]: On test.dbt_challenge.order_dates_in_the_past: Close
[0m15:51:23.856327 [info ] [Thread-1 (]: 6 of 9 PASS order_dates_in_the_past ............................................ [[32mPASS[0m in 0.82s]
[0m15:51:23.859467 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.order_dates_in_the_past
[0m15:51:23.860474 [debug] [Thread-1 (]: Began running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:51:23.862332 [info ] [Thread-1 (]: 7 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:51:23.866334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.order_dates_in_the_past, now test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:51:23.868334 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:51:23.887349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:51:23.891339 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 15:51:23.869338 => 15:51:23.890338
[0m15:51:23.892340 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:51:23.908344 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:51:23.911344 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:51:23.913458 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:51:23.916368 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:24.564509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:24.565518 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:51:24.567510 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from `my_dbt_db`.`stg_orders`
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from `my_dbt_db`.`stg_customers`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m15:51:24.728550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:24.734552 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 15:51:23.893339 => 15:51:24.733553
[0m15:51:24.735552 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:51:24.737554 [debug] [Thread-1 (]: On test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:51:24.742554 [info ] [Thread-1 (]: 7 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.88s]
[0m15:51:24.744559 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:51:24.746554 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:51:24.749674 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m15:51:24.751907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_challenge.unique_stg_customers_customer_id.c7614daada)
[0m15:51:24.754002 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:51:24.776913 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:51:24.782940 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (compile): 15:51:24.754907 => 15:51:24.779914
[0m15:51:24.787921 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:51:24.794056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:51:24.799921 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:51:24.802922 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m15:51:24.804060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:25.450082 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:25.452083 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"
[0m15:51:25.453083 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_customers`
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:51:25.459084 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:25.465087 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_customers_customer_id.c7614daada (execute): 15:51:24.788916 => 15:51:25.463086
[0m15:51:25.466086 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m15:51:25.468089 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_customers_customer_id.c7614daada: Close
[0m15:51:25.473087 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.72s]
[0m15:51:25.476201 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_customers_customer_id.c7614daada
[0m15:51:25.477088 [debug] [Thread-1 (]: Began running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:51:25.479088 [info ] [Thread-1 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:51:25.482091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_challenge.unique_stg_customers_customer_id.c7614daada, now test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a)
[0m15:51:25.484093 [debug] [Thread-1 (]: Began compiling node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:51:25.498097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:51:25.503101 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (compile): 15:51:25.485091 => 15:51:25.502096
[0m15:51:25.505096 [debug] [Thread-1 (]: Began executing node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:51:25.511232 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:51:25.517101 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:51:25.519101 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:51:25.521101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:26.176266 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:26.177266 [debug] [Thread-1 (]: Using mysql connection "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"
[0m15:51:26.178267 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "dbt_challenge", "target_name": "dev", "node_id": "test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_warn,
      case
        when count(*) <> 0 then 'true'
        else 'false'
      end as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from `my_dbt_db`.`stg_orders`
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:51:26.483344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:51:26.487345 [debug] [Thread-1 (]: Timing info for test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a (execute): 15:51:25.505096 => 15:51:26.486345
[0m15:51:26.489345 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:51:26.490362 [debug] [Thread-1 (]: On test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:51:26.495345 [info ] [Thread-1 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 1.01s]
[0m15:51:26.498348 [debug] [Thread-1 (]: Finished running node test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a
[0m15:51:26.502470 [debug] [MainThread]: Using mysql connection "master"
[0m15:51:26.504472 [debug] [MainThread]: On master: BEGIN
[0m15:51:26.505348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:27.402572 [debug] [MainThread]: SQL status: SUCCESS 0 in 1.0 seconds
[0m15:51:27.404574 [debug] [MainThread]: On master: COMMIT
[0m15:51:27.405573 [debug] [MainThread]: Using mysql connection "master"
[0m15:51:27.406574 [debug] [MainThread]: On master: COMMIT
[0m15:51:27.409575 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:51:27.410574 [debug] [MainThread]: On master: Close
[0m15:51:27.416578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:27.417577 [debug] [MainThread]: Connection 'list_None_my_dbt_db' was properly closed.
[0m15:51:27.418668 [debug] [MainThread]: Connection 'test.dbt_challenge.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:51:27.419668 [info ] [MainThread]: 
[0m15:51:27.421578 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 9.92 seconds (9.92s).
[0m15:51:27.428577 [debug] [MainThread]: Command end result
[0m15:51:27.459587 [info ] [MainThread]: 
[0m15:51:27.461589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:27.465589 [info ] [MainThread]: 
[0m15:51:27.469605 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m15:51:27.474659 [debug] [MainThread]: Command `dbt test` succeeded at 15:51:27.473684 after 12.45 seconds
[0m15:51:27.475590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BBA3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BD0CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6BD0CBF0>]}
[0m15:51:27.477592 [debug] [MainThread]: Flushing usage events
